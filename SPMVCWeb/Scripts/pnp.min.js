/**
 * sp-pnp-js v1.0.6 - A reusable JavaScript library targeting SharePoint client-side development.
 * MIT (https://github.com/OfficeDev/PnP-JS-Core/blob/master/LICENSE)
 * Copyright (c) 2016 Microsoft
 * docs: http://officedev.github.io/PnP-JS-Core
 * source: https://github.com/SharePoint/PnP-JS-Core
 * bugs: https://github.com/SharePoint/PnP-JS-Core/issues
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.$pnp=e()}}(function(){return function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";var r=e("../utils/util"),o=function(){function e(){this.keys=[],this.values=[]}return e.prototype.get=function(e){var t=this.keys.indexOf(e);return t<0?null:this.values[t]},e.prototype.add=function(e,t){var n=this.keys.indexOf(e);n>-1?this.values[n]=t:(this.keys.push(e),this.values.push(t))},e.prototype.merge=function(e){if(r.Util.isFunction(e.getKeys))for(var t=e,n=t.getKeys(),o=n.length,i=0;i<o;i++)this.add(n[i],t.get(n[i]));else{var a=e;for(var s in a)a.hasOwnProperty(s)&&this.add(s,e[s])}},e.prototype.remove=function(e){var t=this.keys.indexOf(e);if(t<0)return null;var n=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),n},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys=[],this.values=[]},e.prototype.count=function(){return this.keys.length},e}();n.Dictionary=o},{"../utils/util":45}],2:[function(e,t,n){"use strict";var r=e("../collections/collections"),o=e("./providers/providers"),i=function(){function e(){this.Providers=o,this._settings=new r.Dictionary}return e.prototype.add=function(e,t){this._settings.add(e,t)},e.prototype.addJSON=function(e,t){this._settings.add(e,JSON.stringify(t))},e.prototype.apply=function(e){var t=this;return new Promise(function(n,r){try{t._settings.merge(e),n()}catch(e){r(e)}})},e.prototype.load=function(e){var t=this;return new Promise(function(n,r){e.getConfiguration().then(function(e){t._settings.merge(e),n()}).catch(function(e){r(e)})})},e.prototype.get=function(e){return this._settings.get(e)},e.prototype.getJSON=function(e){var t=this.get(e);return"undefined"==typeof t||null===t?t:JSON.parse(t)},e}();n.Settings=i},{"../collections/collections":1,"./providers/providers":5}],3:[function(e,t,n){(function(e){"use strict";function t(e){o.set(e)}var r=function(){function t(){this._headers=null,this._defaultCachingStore="session",this._defaultCachingTimeoutSeconds=30,this._globalCacheDisable=!1,this._useSPRequestExecutor=!1}return t.prototype.set=function(t){t.hasOwnProperty("headers")&&(this._headers=t.headers),t.hasOwnProperty("globalCacheDisable")&&(this._globalCacheDisable=t.globalCacheDisable),t.hasOwnProperty("defaultCachingStore")&&(this._defaultCachingStore=t.defaultCachingStore),t.hasOwnProperty("defaultCachingTimeoutSeconds")&&(this._defaultCachingTimeoutSeconds=t.defaultCachingTimeoutSeconds),t.hasOwnProperty("useSPRequestExecutor")&&(this._useSPRequestExecutor=t.useSPRequestExecutor),t.hasOwnProperty("nodeClientOptions")&&(this._useNodeClient=!0,this._useSPRequestExecutor=!1,this._nodeClientData=t.nodeClientOptions,e._spPageContextInfo={webAbsoluteUrl:t.nodeClientOptions.siteUrl})},Object.defineProperty(t.prototype,"headers",{get:function(){return this._headers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultCachingStore",{get:function(){return this._defaultCachingStore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this._defaultCachingTimeoutSeconds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalCacheDisable",{get:function(){return this._globalCacheDisable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useSPRequestExecutor",{get:function(){return this._useSPRequestExecutor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useNodeFetchClient",{get:function(){return this._useNodeClient},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodeRequestOptions",{get:function(){return this._nodeClientData},enumerable:!0,configurable:!0}),t}();n.RuntimeConfigImpl=r;var o=new r;n.RuntimeConfig=o,n.setRuntimeConfig=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){"use strict";var r=e("../../utils/storage"),o=function(){function e(e,t,n){this.wrappedProvider=e,this.store=n?n:this.selectPnPCache(),this.cacheKey="_configcache_"+t}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;if(!this.store||!this.store.enabled)return this.wrappedProvider.getConfiguration();var t=this.store.get(this.cacheKey);if(t)return new Promise(function(e,n){e(t)});var n=this.wrappedProvider.getConfiguration();return n.then(function(t){e.store.put(e.cacheKey,t)}),n},e.prototype.selectPnPCache=function(){var e=new r.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw new Error("Cannot create a caching configuration provider since cache is not available.")},e}();Object.defineProperty(n,"__esModule",{value:!0}),n.default=o},{"../../utils/storage":44}],5:[function(e,t,n){"use strict";var r=e("./cachingConfigurationProvider"),o=e("./spListConfigurationProvider");n.CachingConfigurationProvider=r.default,n.SPListConfigurationProvider=o.default},{"./cachingConfigurationProvider":4,"./spListConfigurationProvider":6}],6:[function(e,t,n){"use strict";var r=e("./cachingConfigurationProvider"),o=function(){function e(e,t){void 0===t&&(t="config"),this.sourceWeb=e,this.sourceListTitle=t}return Object.defineProperty(e.prototype,"web",{get:function(){return this.sourceWeb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listTitle",{get:function(){return this.sourceListTitle},enumerable:!0,configurable:!0}),e.prototype.getConfiguration=function(){return this.web.lists.getByTitle(this.listTitle).items.select("Title","Value").getAs().then(function(e){var t={};return e.forEach(function(e){t[e.Title]=e.Value}),t})},e.prototype.asCaching=function(){var e="splist_"+this.web.toUrl()+"+"+this.listTitle;return new r.default(this,e)},e}();Object.defineProperty(n,"__esModule",{value:!0}),n.default=o},{"./cachingConfigurationProvider":4}],7:[function(e,t,n){"use strict";var r=e("../collections/collections"),o=e("../utils/util"),i=e("../sharepoint/rest/odata"),a=function(){function e(){}return e}();n.CachedDigest=a;var s=function(){function e(e,t){void 0===t&&(t=new r.Dictionary),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,n=this._digests.get(e);if(null!==n){var r=new Date;if(r<n.expiration)return Promise.resolve(n.value)}var s=o.Util.combinePaths(e,"/_api/contextinfo");return t._httpClient.fetchRaw(s,{cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json;odata=verbose","Content-type":"application/json;odata=verbose;charset=utf-8"},method:"POST"}).then(function(e){var t=new i.ODataDefaultParser;return t.parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new a;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.add(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}();n.DigestCache=s},{"../collections/collections":1,"../sharepoint/rest/odata":23,"../utils/util":45}],8:[function(e,t,n){(function(e){"use strict";var t=function(){function t(){}return t.prototype.fetch=function(t,n){return e.fetch(t,n)},t}();n.FetchClient=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,n){"use strict";var r=e("./fetchclient"),o=e("./digestcache"),i=e("../utils/util"),a=e("../configuration/pnplibconfig"),s=e("./sprequestexecutorclient"),u=e("./nodefetchclient"),c=function(){function e(){this._impl=this.getFetchImpl(),this._digestCache=new o.DigestCache(this)}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=this,r=i.Util.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),o=new Headers;if(this.mergeHeaders(o,a.RuntimeConfig.headers),this.mergeHeaders(o,t.headers),o.has("Accept")||o.append("Accept","application/json"),o.has("Content-Type")||o.append("Content-Type","application/json;odata=verbose;charset=utf-8"),o.has("X-ClientService-ClientTag")||o.append("X-ClientService-ClientTag","PnPCoreJS:1.0.6"),r=i.Util.extend(r,{headers:o}),r.method&&"GET"!==r.method.toUpperCase()&&!o.has("X-RequestDigest")){var s=e.indexOf("_api/");if(s<0)throw new Error("Unable to determine API url");var u=e.substr(0,s);return this._digestCache.getDigest(u).then(function(t){return o.append("X-RequestDigest",t),n.fetchRaw(e,r)})}return n.fetchRaw(e,r)},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var r=new Headers;this.mergeHeaders(r,t.headers),t=i.Util.extend(t,{headers:r});var o=function(r){n._impl.fetch(e,t).then(function(e){return r.resolve(e)}).catch(function(e){var t=r.delay;429!==e.status&&503!==e.status&&r.reject(e),r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(e),setTimeout(i.Util.getCtxCallback(n,o,r),t)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};o.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=i.Util.extend(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=i.Util.extend(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=i.Util.extend(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=i.Util.extend(t,{method:"DELETE"});return this.fetch(e,n)},e.prototype.getFetchImpl=function(){if(a.RuntimeConfig.useSPRequestExecutor)return new s.SPRequestExecutorClient;if(a.RuntimeConfig.useNodeFetchClient){var e=a.RuntimeConfig.nodeRequestOptions;return new u.NodeFetchClient(e.siteUrl,e.clientId,e.clientSecret)}return new r.FetchClient},e.prototype.mergeHeaders=function(e,t){if("undefined"!=typeof t&&null!==t){var n=new Request("",{headers:t});n.headers.forEach(function(t,n){e.append(n,t)})}},e}();n.HttpClient=c},{"../configuration/pnplibconfig":3,"../utils/util":45,"./digestcache":7,"./fetchclient":8,"./nodefetchclient":10,"./sprequestexecutorclient":11}],10:[function(e,t,n){"use strict";var r=function(){function e(e,t,n,r){void 0===r&&(r=""),this.siteUrl=e,this._clientId=t,this._clientSecret=n,this._realm=r}return e.prototype.fetch=function(e,t){throw new Error("Using NodeFetchClient in the browser is not supported.")},e}();n.NodeFetchClient=r},{}],11:[function(e,t,n){"use strict";var r=e("../utils/util"),o=function(){function e(){this.convertToResponse=function(e){var t=new Headers;for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);return new Response(e.body,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(e,t){var n=this;if("undefined"==typeof SP||"undefined"==typeof SP.RequestExecutor)throw new Error("SP.RequestExecutor is undefined. Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library.");var o,i,a=e.substring(0,e.indexOf("/_api")),s=new SP.RequestExecutor(a),u={};if(t.headers&&t.headers instanceof Headers)for(o=t.headers.entries(),i=o.next();!i.done;)u[i.value[0]]=i.value[1],i=o.next();else u=t.headers;return new Promise(function(o,i){var a={error:function(e){i(n.convertToResponse(e))},headers:u,method:t.method,success:function(e){o(n.convertToResponse(e))},url:e};t.body?r.Util.extend(a,{body:t.body}):r.Util.extend(a,{binaryStringRequestBody:!0}),s.executeAsync(a)})},e}();n.SPRequestExecutorClient=o},{"../utils/util":45}],12:[function(e,t,n){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}var o=e("./utils/util"),i=e("./utils/storage"),a=e("./configuration/configuration"),s=e("./utils/logging"),u=e("./sharepoint/rest/rest"),c=e("./configuration/pnplibconfig");n.util=o.Util,n.sp=new u.Rest,n.storage=new i.PnPClientStorage,n.config=new a.Settings,n.log=s.Logger,n.setup=c.setRuntimeConfig,r(e("./types/index"));var l={config:n.config,log:n.log,setup:n.setup,sp:n.sp,storage:n.storage,util:n.util};Object.defineProperty(n,"__esModule",{value:!0}),n.default=l},{"./configuration/configuration":2,"./configuration/pnplibconfig":3,"./sharepoint/rest/rest":27,"./types/index":41,"./utils/logging":43,"./utils/storage":44,"./utils/util":45}],13:[function(e,t,n){"use strict";var r=e("../../utils/storage"),o=e("../../utils/util"),i=e("../../configuration/pnplibconfig"),a=function(){function e(e){this.key=e,this.expiration=o.Util.dateAdd(new Date,"second",i.RuntimeConfig.defaultCachingTimeoutSeconds),this.storeName=i.RuntimeConfig.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new r.PnPClientStorage,e}();n.CachingOptions=a;var s=function(){function e(e,t){this._parser=e,this._cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this._parser.parse(e).then(function(e){return null!==t._cacheOptions.store&&t._cacheOptions.store.put(t._cacheOptions.key,e,t._cacheOptions.expiration),e})},e}();n.CachingParserWrapper=s},{"../../configuration/pnplibconfig":3,"../../utils/storage":44,"../../utils/util":45}],14:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../../utils/util"),i=e("./queryable"),a=function(e){function t(t,n){void 0===n&&(n="contenttypes"),e.call(this,t,n)}return r(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.addAvailableContentType=function(e){var n=this,r=JSON.stringify({contentTypeId:e});return new t(this,"addAvailableContentType").postAs({body:r}).then(function(e){return{contentType:n.getById(e.id),data:e}})},t.prototype.add=function(e,t,n,r,i){var a=this;void 0===n&&(n=""),void 0===r&&(r="Custom Content Types"),void 0===i&&(i={});var s=JSON.stringify(o.Util.extend({__metadata:{type:"SP.ContentType"},Id:{StringValue:e},Name:t,Group:r,Description:n},i));return this.post({body:s}).then(function(e){return{contentType:a.getById(e.id),data:e}})},t}(i.QueryableCollection);n.ContentTypes=a;var s=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"fieldLinks",{get:function(){return new i.Queryable(this,"fieldLinks")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new i.Queryable(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new t(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workflowAssociations",{get:function(){return new i.Queryable(this,"workflowAssociations")},enumerable:!0,configurable:!0}),t}(i.QueryableInstance);n.ContentType=s},{"../../utils/util":45,"./queryable":24}],15:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("../../utils/util"),a=e("./types"),s=function(e){function t(t,n){void 0===n&&(n="fields"),e.call(this,t,n)}return r(t,e),t.prototype.getByTitle=function(e){return new u(this,"getByTitle('"+e+"')")},t.prototype.getByInternalNameOrTitle=function(e){return new u(this,"getByInternalNameOrTitle('"+e+"')")},t.prototype.getById=function(e){var t=new u(this);return t.concat("('"+e+"')"),t},t.prototype.createFieldAsXml=function(e){var n,r=this;n="string"==typeof e?{SchemaXml:e}:e;var o=JSON.stringify({parameters:i.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},n)}),a=new t(this,"createfieldasxml");return a.postAs({body:o}).then(function(e){return{data:e,field:r.getById(e.Id)}})},t.prototype.add=function(e,t,n){var r=this;void 0===n&&(n={});var o=JSON.stringify(i.Util.extend({__metadata:{type:t},Title:e},n));return this.postAs({body:o}).then(function(e){return{data:e,field:r.getById(e.Id)}})},t.prototype.addText=function(e,t,n){void 0===t&&(t=255);var r={FieldTypeKind:2};return this.add(e,"SP.FieldText",i.Util.extend(r,n))},t.prototype.addCalculated=function(e,t,n,r,o){void 0===r&&(r=a.FieldTypes.Text);var s={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:r};return this.add(e,"SP.FieldCalculated",i.Util.extend(s,o))},t.prototype.addDateTime=function(e,t,n,r,o){void 0===t&&(t=a.DateTimeFieldFormatType.DateOnly),void 0===n&&(n=a.CalendarType.Gregorian),void 0===r&&(r=0);var s={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:r};return this.add(e,"SP.FieldDateTime",i.Util.extend(s,o))},t.prototype.addNumber=function(e,t,n,r){var o={FieldTypeKind:9};return"undefined"!=typeof t&&(o=i.Util.extend({MinimumValue:t},o)),"undefined"!=typeof n&&(o=i.Util.extend({MaximumValue:n},o)),this.add(e,"SP.FieldNumber",i.Util.extend(o,r))},t.prototype.addCurrency=function(e,t,n,r,o){void 0===r&&(r=1033);var a={CurrencyLocaleId:r,FieldTypeKind:10};return"undefined"!=typeof t&&(a=i.Util.extend({MinimumValue:t},a)),"undefined"!=typeof n&&(a=i.Util.extend({MaximumValue:n},a)),this.add(e,"SP.FieldCurrency",i.Util.extend(a,o))},t.prototype.addMultilineText=function(e,t,n,r,o,a,s){void 0===t&&(t=6),void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!0);var u={AllowHyperlink:a,AppendOnly:o,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:r,RichText:n};return this.add(e,"SP.FieldMultiLineText",i.Util.extend(u,s))},t.prototype.addUrl=function(e,t,n){void 0===t&&(t=a.UrlFieldFormatType.Hyperlink);var r={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",i.Util.extend(r,n))},t}(o.QueryableCollection);n.Fields=s;var u=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),t.prototype.update=function(e,t){var n=this;void 0===t&&(t="SP.Field");var r=JSON.stringify(i.Util.extend({__metadata:{type:t}},e));return this.post({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:n}})},t.prototype.delete=function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.setShowInDisplayForm=function(e){var n=new t(this,"setshowindisplayform("+e+")");return n.post()},t.prototype.setShowInEditForm=function(e){var n=new t(this,"setshowineditform("+e+")");return n.post()},t.prototype.setShowInNewForm=function(e){var n=new t(this,"setshowinnewform("+e+")");return n.post()},t}(o.QueryableInstance);n.Field=u},{"../../utils/util":45,"./queryable":24,"./types":36}],16:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./items"),a=e("../../utils/util"),s=function(e){function t(t,n){void 0===n&&(n="files"),e.call(this,t,n)}return r(t,e),t.prototype.getByName=function(e){var t=new u(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,n,r){var o=this;return void 0===r&&(r=!0),new t(this,"add(overwrite="+r+",url='"+e+"')").post({body:n}).then(function(t){return{data:t,file:o.getByName(e)}})},t.prototype.addChunked=function(e,n,r,o,i){var a=this;void 0===o&&(o=!0),void 0===i&&(i=10485760);var s=new t(this,"add(overwrite="+o+",url='"+e+"')");return s.post().then(function(){return a.getByName(e)}).then(function(e){return e.setContentChunked(n,r,i)}).then(function(t){return{data:t,file:a.getByName(e)}})},t.prototype.addTemplateFile=function(e,n){var r=this;return new t(this,"addTemplateFile(urloffile='"+e+"',templatefiletype="+n+")").post().then(function(t){return{data:t,file:r.getByName(e)}})},t}(o.QueryableCollection);n.Files=s;var u=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new i.Item(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new f(this)},enumerable:!0,configurable:!0}),t.prototype.approve=function(e){return new t(this,"approve(comment='"+e+"')").post()},t.prototype.cancelUpload=function(e){return new t(this,"cancelUpload(uploadId=guid'"+e+"')").post()},t.prototype.checkin=function(e,n){return void 0===e&&(e=""),void 0===n&&(n=h.Major),new t(this,"checkin(comment='"+e+"',checkintype="+n+")").post()},t.prototype.checkout=function(){return new t(this,"checkout").post()},t.prototype.copyTo=function(e,n){return void 0===n&&(n=!0),new t(this,"copyTo(strnewurl='"+e+"',boverwrite="+n+")").post()},t.prototype.delete=function(e){return void 0===e&&(e="*"),new t(this).post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.deny=function(e){return void 0===e&&(e=""),new t(this,"deny(comment='"+e+"')").post()},t.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=y.User),new o.Queryable(this,"getLimitedWebPartManager(scope="+e+")")},t.prototype.moveTo=function(e,n){return void 0===n&&(n=g.Overwrite),new t(this,"moveTo(newurl='"+e+"',flags="+n+")").post()},t.prototype.publish=function(e){return void 0===e&&(e=""),new t(this,"publish(comment='"+e+"')").post()},t.prototype.recycle=function(){return new t(this,"recycle").post()},t.prototype.undoCheckout=function(){return new t(this,"undoCheckout").post()},t.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new Error("The maximum comment length is 1023 characters.");return new t(this,"unpublish(comment='"+e+"')").post()},t.prototype.getText=function(){return new t(this,"$value").get(new c,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBlob=function(){return new t(this,"$value").get(new l,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBuffer=function(){return new t(this,"$value").get(new p,{headers:{binaryStringResponseBody:"true"}})},t.prototype.setContent=function(e){var n=this,r=new t(this,"$value");return r.post({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.setContentChunked=function(e,t,n){void 0===n&&(n=10485760),"undefined"==typeof t&&(t=function(e){return null});var r=this,o=e.size,i=parseInt((e.size/n).toString(),10)+(e.size%n===0?1:0);console.log("blockCount: "+i);var s=a.Util.getGUID();t({blockNumber:1,chunkSize:n,currentPointer:0,fileSize:o,stage:"starting",totalBlocks:i});for(var u=r.startUpload(s,e.slice(0,n)),c=function(a){u=u.then(function(u){return t({blockNumber:a,chunkSize:n,currentPointer:u,fileSize:o,stage:"continue",totalBlocks:i}),r.continueUpload(s,u,e.slice(u,u+n))})},l=2;l<i;l++)c(l);return u.then(function(a){return t({blockNumber:i,chunkSize:n,currentPointer:a,fileSize:o,stage:"finishing",totalBlocks:i}),r.finishUpload(s,a,e.slice(a))}).then(function(e){return r})},t.prototype.startUpload=function(e,n){return new t(this,"startUpload(uploadId=guid'"+e+"')").postAs({body:n}).then(function(e){return parseFloat(e)})},t.prototype.continueUpload=function(e,n,r){return new t(this,"continueUpload(uploadId=guid'"+e+"',fileOffset="+n+")").postAs({body:r}).then(function(e){return parseFloat(e)})},t.prototype.finishUpload=function(e,n,r){return new t(this,"finishUpload(uploadId=guid'"+e+"',fileOffset="+n+")").postAs({body:r}).then(function(e){return{data:e,file:new t(e.ServerRelativeUrl)}})},t}(o.QueryableInstance);n.File=u;var c=function(){function e(){}return e.prototype.parse=function(e){return e.text()},e}();n.TextFileParser=c;var l=function(){function e(){}return e.prototype.parse=function(e){return e.blob()},e}();n.BlobFileParser=l;var p=function(){function e(){}return e.prototype.parse=function(e){return a.Util.isFunction(e.arrayBuffer)?e.arrayBuffer():e.buffer()},e}();n.BufferFileParser=p;var f=function(e){function t(t,n){void 0===n&&(n="versions"),e.call(this,t,n)}return r(t,e),t.prototype.getById=function(e){var t=new d(this);return t.concat("("+e+")"),t},t.prototype.deleteAll=function(){return new t(this,"deleteAll").post()},t.prototype.deleteById=function(e){return new t(this,"deleteById(vid="+e+")").post()},t.prototype.deleteByLabel=function(e){return new t(this,"deleteByLabel(versionlabel='"+e+"')").post()},t.prototype.restoreByLabel=function(e){return new t(this,"restoreByLabel(versionlabel='"+e+"')").post()},t}(o.QueryableCollection);n.Versions=f;var d=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),t.prototype.delete=function(e){return void 0===e&&(e="*"),this.post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(o.QueryableInstance);n.Version=d,function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(n.CheckinType||(n.CheckinType={}));var h=n.CheckinType;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(n.WebPartsPersonalizationScope||(n.WebPartsPersonalizationScope={}));var y=n.WebPartsPersonalizationScope;!function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(n.MoveOperations||(n.MoveOperations={}));var g=n.MoveOperations;!function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage"}(n.TemplateFileType||(n.TemplateFileType={}));n.TemplateFileType},{"../../utils/util":45,"./items":20,"./queryable":24}],17:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./files"),a=e("./items"),s=function(e){function t(t,n){void 0===n&&(n="folders"),e.call(this,t,n)}return r(t,e),t.prototype.getByName=function(e){var t=new u(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var n=this;return new t(this,"add('"+e+"')").post().then(function(t){return{data:t,folder:n.getByName(e)}})},t}(o.QueryableCollection);n.Folders=s;var u=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"contentTypeOrder",{get:function(){return new o.QueryableCollection(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return new i.Files(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new a.Item(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFolder",{get:function(){return new t(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return new o.QueryableInstance(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return new o.Queryable(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueContentTypeOrder",{get:function(){return new o.QueryableCollection(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),t.prototype.delete=function(e){return void 0===e&&(e="*"),new t(this).post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return new t(this,"recycle").post()},t}(o.QueryableInstance);n.Folder=u},{"./files":16,"./items":20,"./queryable":24}],18:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=function(e){function t(t,n){void 0===n&&(n="forms"),e.call(this,t,n)}return r(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t}(o.QueryableCollection);n.Forms=i;var a=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),t}(o.QueryableInstance);n.Form=a},{"./queryable":24}],19:[function(e,t,n){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}r(e("./caching"));var o=e("./files");n.CheckinType=o.CheckinType,n.WebPartsPersonalizationScope=o.WebPartsPersonalizationScope,n.MoveOperations=o.MoveOperations,n.TemplateFileType=o.TemplateFileType,n.TextFileParser=o.TextFileParser,n.BlobFileParser=o.BlobFileParser,n.BufferFileParser=o.BufferFileParser;var i=e("./items");n.PagedItemCollection=i.PagedItemCollection;var a=e("./odata");n.extractOdataId=a.extractOdataId,n.ODataParserBase=a.ODataParserBase,n.ODataDefaultParser=a.ODataDefaultParser,n.ODataRaw=a.ODataRaw,n.ODataValue=a.ODataValue,n.ODataEntity=a.ODataEntity,n.ODataEntityArray=a.ODataEntityArray;var s=e("./roles");n.RoleDefinitionBindings=s.RoleDefinitionBindings;var u=e("./search");n.Search=u.Search,n.SearchResult=u.SearchResult,n.SearchResults=u.SearchResults,n.SortDirection=u.SortDirection,n.ReorderingRuleMatchType=u.ReorderingRuleMatchType,n.QueryPropertyValueType=u.QueryPropertyValueType;var c=e("./searchsuggest");n.SearchSuggest=c.SearchSuggest,n.SearchSuggestResult=c.SearchSuggestResult;var l=e("./site");n.Site=l.Site,r(e("./types"));var p=e("./webs");n.Web=p.Web},{"./caching":13,"./files":16,"./items":20,"./odata":23,"./roles":28,"./search":29,"./searchsuggest":30,"./site":31,"./types":36,"./webs":40}],20:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./queryablesecurable"),a=e("./folders"),s=e("./contenttypes"),u=e("../../utils/util"),c=e("./odata"),l=function(e){function t(t,n){void 0===n&&(n="items"),e.call(this,t,n)}return r(t,e),t.prototype.getById=function(e){var t=new p(this);return t.concat("("+e+")"),t},t.prototype.skip=function(e){return this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},t.prototype.getPaged=function(){return this.getAs(new d)},t.prototype.add=function(e){var t=this;void 0===e&&(e={});var n=this.addBatchDependency(),r=this.getParent(o.QueryableInstance);return r.select("ListItemEntityTypeFullName").getAs().then(function(r){var o=JSON.stringify(u.Util.extend({__metadata:{type:r.ListItemEntityTypeFullName}},e)),i=t.postAs({body:o}).then(function(e){return{data:e,item:t.getById(e.Id)}});return n(),i})},t}(o.QueryableCollection);n.Items=l;var p=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"attachmentFiles",{get:function(){return new o.QueryableCollection(this,"AttachmentFiles")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return new s.ContentType(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new o.Queryable(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissionsForUI",{get:function(){return new o.Queryable(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsHTML",{get:function(){return new o.QueryableInstance(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsText",{get:function(){return new o.QueryableInstance(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesForEdit",{
get:function(){return new o.QueryableInstance(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folder",{get:function(){return new a.Folder(this,"Folder")},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t){var n=this;void 0===t&&(t="*");var r=this.addBatchDependency(),i=this.getParent(o.QueryableInstance,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")));return i.select("ListItemEntityTypeFullName").getAs().then(function(o){var i=JSON.stringify(u.Util.extend({__metadata:{type:o.ListItemEntityTypeFullName}},e)),a=n.post({body:i,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,item:n}});return r(),a})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){var e=new t(this,"recycle");return e.post()},t.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var n=new t(this,"getWOPIFrameUrl(@action)");return n._query.add("@action",e),n.post().then(function(e){return e.GetWOPIFrameUrl})},t.prototype.validateUpdateListItem=function(e,n){void 0===n&&(n=!1);var r=JSON.stringify({formValues:e,bNewDocumentUpdate:n}),o=new t(this,"validateupdatelistitem");return o.post({body:r})},t}(i.QueryableSecurable);n.Item=p;var f=function(){function e(e,t){this.nextUrl=e,this.results=t}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){if(this.hasNext){var e=new l(this.nextUrl,null);return e.getPaged()}return new Promise(function(e){return e(null)})},e}();n.PagedItemCollection=f;var d=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.parse=function(e){var t=this;return e.json().then(function(e){var n=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];return new f(n,t.parseODataJSON(e))})},t}(c.ODataParserBase)},{"../../utils/util":45,"./contenttypes":14,"./folders":17,"./odata":23,"./queryable":24,"./queryablesecurable":25}],21:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./items"),i=e("./views"),a=e("./contenttypes"),s=e("./fields"),u=e("./forms"),c=e("./subscriptions"),l=e("./queryable"),p=e("./queryablesecurable"),f=e("../../utils/util"),d=e("./usercustomactions"),h=e("./odata"),y=function(e){function t(t,n){void 0===n&&(n="lists"),e.call(this,t,n)}return r(t,e),t.prototype.getByTitle=function(e){return new g(this,"getByTitle('"+e+"')")},t.prototype.getById=function(e){var t=new g(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,n,r,o){var i=this;void 0===t&&(t=""),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===o&&(o={});var a=JSON.stringify(f.Util.extend({__metadata:{type:"SP.List"},AllowContentTypes:r,BaseTemplate:n,ContentTypesEnabled:r,Description:t,Title:e},o));return this.post({body:a}).then(function(t){return{data:t,list:i.getByTitle(e)}})},t.prototype.ensure=function(e,t,n,r,o){var i=this;if(void 0===t&&(t=""),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===o&&(o={}),this.hasBatch)throw new Error("The ensure method is not supported as part of a batch.");return new Promise(function(a,s){var u=i.getByTitle(e);u.get().then(function(e){return a({created:!1,data:e,list:u})}).catch(function(){i.add(e,t,n,r,o).then(function(t){a({created:!0,data:t.data,list:i.getByTitle(e)})})}).catch(function(e){return s(e)})})},t.prototype.ensureSiteAssetsLibrary=function(){var e=new t(this,"ensuresiteassetslibrary");return e.post().then(function(e){return new g(h.extractOdataId(e))})},t.prototype.ensureSitePagesLibrary=function(){var e=new t(this,"ensuresitepageslibrary");return e.post().then(function(e){return new g(h.extractOdataId(e))})},t}(l.QueryableCollection);n.Lists=y;var g=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new a.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new o.Items(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"views",{get:function(){return new i.Views(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new s.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forms",{get:function(){return new u.Forms(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultView",{get:function(){return new l.QueryableInstance(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new d.UserCustomActions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new l.Queryable(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventReceivers",{get:function(){return new l.QueryableCollection(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedFields",{get:function(){return new l.Queryable(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"informationRightsManagementSettings",{get:function(){return new l.Queryable(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptions",{get:function(){return new c.Subscriptions(this)},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return new i.View(this,"getView('"+e+"')")},t.prototype.update=function(e,n){var r=this;void 0===n&&(n="*");var o=JSON.stringify(f.Util.extend({__metadata:{type:"SP.List"}},e));return this.post({body:o,headers:{"IF-Match":n,"X-HTTP-Method":"MERGE"}}).then(function(n){var o=r;return e.hasOwnProperty("Title")&&(o=r.getParent(t,r.parentUrl,"getByTitle('"+e.Title+"')")),{data:n,list:o}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getChanges=function(e){var n=JSON.stringify({query:f.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)}),r=new t(this,"getchanges");return r.post({body:n})},t.prototype.getItemsByCAMLQuery=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=JSON.stringify({query:f.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)}),i=new t(this,"getitems");return i=i.expand.apply(i,n),i.post({body:o})},t.prototype.getListItemChangesSinceToken=function(e){var n=JSON.stringify({query:f.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)}),r=new t(this,"getlistitemchangessincetoken");return r.post({body:n},{parse:function(e){return e.text()}})},t.prototype.recycle=function(){return this.append("recycle"),this.post().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},t.prototype.renderListData=function(e){var n=new t(this,"renderlistdata(@viewXml)");return n.query.add("@viewXml","'"+e+"'"),n.post().then(function(e){return e=JSON.parse(e),e.hasOwnProperty("RenderListData")?e.RenderListData:e})},t.prototype.renderListFormData=function(e,n,r){var o=new t(this,"renderlistformdata(itemid="+e+", formid='"+n+"', mode="+r+")");return o.post().then(function(e){return e=JSON.parse(e),e.hasOwnProperty("ListData")?e.ListData:e})},t.prototype.reserveListItemId=function(){var e=new t(this,"reservelistitemid");return e.post().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},t}(p.QueryableSecurable);n.List=g},{"../../utils/util":45,"./contenttypes":14,"./fields":15,"./forms":18,"./items":20,"./odata":23,"./queryable":24,"./queryablesecurable":25,"./subscriptions":34,"./usercustomactions":37,"./views":39}],22:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./quicklaunch"),a=e("./topnavigationbar"),s=function(e){function t(t){e.call(this,t,"navigation")}return r(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new i.QuickLaunch(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new a.TopNavigationBar(this)},enumerable:!0,configurable:!0}),t}(o.Queryable);n.Navigation=s},{"./queryable":24,"./quicklaunch":26,"./topnavigationbar":35}],23:[function(e,t,n){"use strict";function r(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw l.Logger.log({data:e,level:l.LogLevel.Error,message:"Could not extract odata id in object, you may be using nometadata. Object data logged to logger."}),new Error("Could not extract odata id in object, you may be using nometadata. Object data logged to logger.")}function o(e){return e.hasOwnProperty("__metadata")?e.__metadata.uri:e.hasOwnProperty("odata.editLink")?c.Util.combinePaths("_api",e["odata.editLink"]):(l.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",l.LogLevel.Warning),"")}function i(){return new g}function a(e){return new b(e)}function s(e){return new v(e)}var u=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},c=e("../../utils/util"),l=e("../../utils/logging"),p=e("../../net/httpclient"),f=e("../../configuration/pnplibconfig");n.extractOdataId=r;var d=function(){function e(){}return e.prototype.parse=function(e){var t=this;return e.json().then(function(e){return t.parseODataJSON(e)})},e.prototype.parseODataJSON=function(e){var t=e;return e.hasOwnProperty("d")?t=e.d.hasOwnProperty("results")?e.d.results:e.d:e.hasOwnProperty("value")&&(t=e.value),t},e}();n.ODataParserBase=d;var h=function(e){function t(){e.apply(this,arguments)}return u(t,e),t}(d);n.ODataDefaultParser=h;var y=function(){function e(){}return e.prototype.parse=function(e){return e.json()},e}();n.ODataRawParserImpl=y;var g=function(e){function t(){e.apply(this,arguments)}return u(t,e),t.prototype.parse=function(t){return e.prototype.parse.call(this,t).then(function(e){return e})},t}(d),b=function(e){function t(t){e.call(this),this.factory=t}return u(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){var t=new n.factory(o(e),null);return c.Util.extend(t,e)})},t}(d),v=function(e){function t(t){e.call(this),this.factory=t}return u(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new n.factory(o(e),null);return c.Util.extend(t,e)})})},t}(d);n.ODataRaw=new y,n.ODataValue=i,n.ODataEntity=a,n.ODataEntityArray=s;var m=function(){function e(e,t){void 0===t&&(t=c.Util.getGUID()),this.baseUrl=e,this._batchId=t,this._requests=[],this._batchDependencies=Promise.resolve()}return e.prototype.add=function(e,t,n,r){var o={method:t.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:e},i=new Promise(function(e,t){o.resolve=e,o.reject=t});return this._requests.push(o),i},e.prototype.addBatchDependency=function(){var e,t=new Promise(function(t){e=t});return this._batchDependencies=this._batchDependencies.then(function(){return t}),e},e.prototype.execute=function(){var e=this;return this._batchDependencies.then(function(){return e.executeImpl()})},e.prototype.executeImpl=function(){var e=this;if(this._requests.length<1)return Promise.resolve();var t=[],n="";this._requests.forEach(function(r,o){"GET"===r.method?(n.length>0&&(t.push("--changeset_"+n+"--\n\n"),n=""),t.push("--batch_"+e._batchId+"\n")):(n.length<1&&(n=c.Util.getGUID(),t.push("--batch_"+e._batchId+"\n"),t.push('Content-Type: multipart/mixed; boundary="changeset_'+n+'"\n\n')),t.push("--changeset_"+n+"\n")),t.push("Content-Type: application/http\n"),t.push("Content-Transfer-Encoding: binary\n\n");var i={Accept:"application/json;"};if("GET"!==r.method){var a=r.method;r.options&&r.options.headers&&"undefined"!==r.options.headers["X-HTTP-Method"]&&(a=r.options.headers["X-HTTP-Method"],delete r.options.headers["X-HTTP-Method"]),t.push(a+" "+r.url+" HTTP/1.1\n"),i=c.Util.extend(i,{"Content-Type":"application/json;odata=verbose;charset=utf-8"})}else t.push(r.method+" "+r.url+" HTTP/1.1\n");"undefined"!=typeof f.RuntimeConfig.headers&&(i=c.Util.extend(i,f.RuntimeConfig.headers)),r.options&&r.options.headers&&(i=c.Util.extend(i,r.options.headers));for(var s in i)i.hasOwnProperty(s)&&t.push(s+": "+i[s]+"\n");t.push("\n"),r.options.body&&t.push(r.options.body+"\n\n")}),n.length>0&&(t.push("--changeset_"+n+"--\n\n"),n=""),t.push("--batch_"+this._batchId+"--\n");var r={"Content-Type":"multipart/mixed; boundary=batch_"+this._batchId},o={body:t.join(""),headers:r},i=new p.HttpClient,a=c.Util.makeUrlAbsolute(c.Util.combinePaths(this.baseUrl,"/_api/$batch"));return i.post(a,o).then(function(e){return e.text()}).then(this._parseResponse).then(function(t){if(t.length!==e._requests.length)throw new Error("Could not properly parse responses to match requests in batch.");for(var n=Promise.resolve(),r=function(r){var o=e._requests[r],i=t[r];i.ok||o.reject(new Error(i.statusText)),n=n.then(function(e){return o.parser.parse(i).then(o.resolve).catch(o.reject)})},o=0;o<t.length;o++)r(o);return n})},e.prototype._parseResponse=function(e){return new Promise(function(t,n){for(var r,o,i=[],a="--batchresponse_",s=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),u=e.split("\n"),c="batch",l=0;l<u.length;++l){var p=u[l];switch(c){case"batch":if(p.substr(0,a.length)===a)c="batchHeaders";else if(""!==p.trim())throw new Error("Invalid response, line "+l);break;case"batchHeaders":""===p.trim()&&(c="status");break;case"status":var f=s.exec(p);if(3!==f.length)throw new Error("Invalid status, line "+l);r=parseInt(f[1],10),o=f[2],c="statusHeaders";break;case"statusHeaders":""===p.trim()&&(c="body");break;case"body":var d=void 0;d=204===r?new Response:new Response(p,{status:r,statusText:o}),i.push(d),c="batch"}}"status"!==c&&n(new Error("Unexpected end of input")),t(i)})},e}();n.ODataBatch=m},{"../../configuration/pnplibconfig":3,"../../net/httpclient":9,"../../utils/logging":43,"../../utils/util":45}],24:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../../utils/util"),i=e("../../utils/logging"),a=e("../../collections/collections"),s=e("../../net/httpclient"),u=e("./odata"),c=e("./caching"),l=e("../../configuration/pnplibconfig"),p=function(){function e(e,t){if(this._query=new a.Dictionary,this._batch=null,"string"==typeof e){var n=e;if(o.Util.isUrlAbsolute(n)||n.lastIndexOf("/")<0)this._parentUrl=n,this._url=o.Util.combinePaths(n,t);else if(n.lastIndexOf("/")>n.lastIndexOf("(")){var r=n.lastIndexOf("/");this._parentUrl=n.slice(0,r),t=o.Util.combinePaths(n.slice(r),t),this._url=o.Util.combinePaths(this._parentUrl,t)}else{var r=n.lastIndexOf("(");this._parentUrl=n.slice(0,r),this._url=o.Util.combinePaths(n,t)}}else{var i=e;this._parentUrl=i._url;var s=i._query.get("@target");null!==s&&this._query.add("@target",s),this._url=o.Util.combinePaths(this._parentUrl,t)}}return e.prototype.concat=function(e){this._url+=e},e.prototype.append=function(e){this._url=o.Util.combinePaths(this._url,e)},e.prototype.addBatchDependency=function(){return this.hasBatch?this._batch.addBatchDependency():function(){return null}},Object.defineProperty(e.prototype,"hasBatch",{get:function(){return null!==this._batch},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.inBatch=function(e){if(null!==this._batch)throw new Error("This query is already part of a batch.");return this._batch=e,this},e.prototype.usingCaching=function(e){return l.RuntimeConfig.globalCacheDisable||(this._useCaching=!0,this._cachingOptions=e),this},e.prototype.toUrl=function(){return o.Util.makeUrlAbsolute(this._url)},e.prototype.toUrlAndQuery=function(){var e=this,t=this.toUrl();if(this._query.count()>0){t+="?";var n=this._query.getKeys();t+=n.map(function(t,n,r){return t+"="+e._query.get(t)}).join("&")}return t},e.prototype.get=function(e,t){return void 0===e&&(e=new u.ODataDefaultParser),void 0===t&&(t={}),this.getImpl(t,e)},e.prototype.getAs=function(e,t){return void 0===e&&(e=new u.ODataDefaultParser),void 0===t&&(t={}),this.getImpl(t,e)},e.prototype.post=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new u.ODataDefaultParser),this.postImpl(e,t)},e.prototype.postAs=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new u.ODataDefaultParser),this.postImpl(e,t)},e.prototype.patch=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new u.ODataDefaultParser),this.patchImpl(e,t)},e.prototype.delete=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new u.ODataDefaultParser),this.deleteImpl(e,t)},e.prototype.getParent=function(e,t,n){void 0===t&&(t=this.parentUrl);var r=new e(t,n),o=this.query.get("@target");return null!==o&&r.query.add("@target",o),r},e.prototype.getImpl=function(e,t){var n=this;if(void 0===e&&(e={}),this._useCaching){var r=new c.CachingOptions(this.toUrlAndQuery().toLowerCase());if("undefined"!=typeof this._cachingOptions&&(r=o.Util.extend(r,this._cachingOptions)),null!==r.store){var i=r.store.get(r.key);if(null!==i)return new Promise(function(e){return e(i)})}t=new c.CachingParserWrapper(t,r)}if(this.hasBatch)return this._batch.add(this.toUrlAndQuery(),"GET",e,t);var a=new s.HttpClient;return a.get(this.toUrlAndQuery(),e).then(function(e){return n.processHttpClientResponse(e,t)})},e.prototype.postImpl=function(e,t){var n=this;if(this.hasBatch)return this._batch.add(this.toUrlAndQuery(),"POST",e,t);var r=new s.HttpClient;return r.post(this.toUrlAndQuery(),e).then(function(e){return n.processHttpClientResponse(e,t)})},e.prototype.patchImpl=function(e,t){var n=this;if(this.hasBatch)return this._batch.add(this.toUrlAndQuery(),"PATCH",e,t);var r=new s.HttpClient;return r.patch(this.toUrlAndQuery(),e).then(function(e){return n.processHttpClientResponse(e,t)})},e.prototype.deleteImpl=function(e,t){var n=this;if(this.hasBatch)return this._batch.add(this.toUrlAndQuery(),"DELETE",e,t);var r=new s.HttpClient;return r.delete(this.toUrlAndQuery(),e).then(function(e){return n.processHttpClientResponse(e,t)})},e.prototype.processHttpClientResponse=function(e,t){return e.ok||e.text().then(function(t){throw i.Logger.log({data:e,level:i.LogLevel.Error,message:t}),"Error making HttpClient request in queryable: "+e.statusText}),e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?new Promise(function(e,t){e({})}):t.parse(e)},e}();n.Queryable=p;var f=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var n=this._query.getKeys(),r=[],o=t?" asc":" desc",i=0;i<n.length;i++)if("$orderby"===n[i]){r.push(this._query.get("$orderby"));break}return r.push(""+e+o),this._query.add("$orderby",r.join(",")),this},t.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t}(p);n.QueryableCollection=f;var d=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this._query.add("$expand",e.join(",")),this},t}(p);n.QueryableInstance=d},{"../../collections/collections":1,"../../configuration/pnplibconfig":3,"../../net/httpclient":9,"../../utils/logging":43,"../../utils/util":45,"./caching":13,"./odata":23}],25:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./roles"),i=e("./queryable"),a=function(e){function t(){e.apply(this,arguments)}return r(t,e),Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new o.RoleAssignments(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return this.append("FirstUniqueAncestorSecurableObject"),new i.QueryableInstance(this)},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){return this.append("getUserEffectivePermissions(@user)"),this._query.add("@user","'"+encodeURIComponent(e)+"'"),new i.Queryable(this)},t.prototype.breakRoleInheritance=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var n=function(e){function t(t,n,r){e.call(this,t,"breakroleinheritance(copyroleassignments="+n+", clearsubscopes="+r+")")}return r(t,e),t.prototype.break=function(){return this.post()},t}(i.Queryable),o=new n(this,e,t);return o.break()},t.prototype.resetRoleInheritance=function(){var e=function(e){function t(t){e.call(this,t,"resetroleinheritance")}return r(t,e),t.prototype.reset=function(){return this.post()},t}(i.Queryable),t=new e(this);return t.reset()},t}(i.QueryableInstance);n.QueryableSecurable=a},{"./queryable":24,"./roles":28}],26:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=function(e){function t(t){e.call(this,t,"QuickLaunch")}return r(t,e),t}(o.Queryable);n.QuickLaunch=i},{"./queryable":24}],27:[function(e,t,n){"use strict";var r=e("./search"),o=e("./searchsuggest"),i=e("./site"),a=e("./webs"),s=e("../../utils/util"),u=e("./userprofiles"),c=function(){function e(){}return e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,new o.SearchSuggest("").execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e,new r.Search("").execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return new i.Site("")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return new a.Web("")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return new u.UserProfileQuery("")},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},e.prototype.crossDomainSite=function(e,t){return this._cdImpl(i.Site,e,t,"site")},e.prototype.crossDomainWeb=function(e,t){return this._cdImpl(a.Web,e,t,"web")},e.prototype._cdImpl=function(e,t,n,r){if(!s.Util.isUrlAbsolute(t))throw"The addInWebUrl parameter must be an absolute url.";if(!s.Util.isUrlAbsolute(n))throw"The hostWebUrl parameter must be an absolute url.";var o=s.Util.combinePaths(t,"_api/SP.AppContextSite(@target)"),i=new e(o,r);return i.query.add("@target","'"+encodeURIComponent(n)+"'"),i},e}();n.Rest=c},{"../../utils/util":45,"./search":29,"./searchsuggest":30,"./site":31,"./userprofiles":38,"./webs":40}],28:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./sitegroups"),a=e("../../utils/util"),s=function(e){function t(t,n){void 0===n&&(n="roleassignments"),e.call(this,t,n)}return r(t,e),t.prototype.add=function(e,n){var r=new t(this,"addroleassignment(principalid="+e+", roledefid="+n+")");return r.post()},t.prototype.remove=function(e,n){var r=new t(this,"removeroleassignment(principalid="+e+", roledefid="+n+")");return r.post()},t.prototype.getById=function(e){var t=new u(this);return t.concat("("+e+")"),t},t}(o.QueryableCollection);n.RoleAssignments=s;var u=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.SiteGroups(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return new p(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.QueryableInstance);n.RoleAssignment=u;var c=function(e){function t(t,n){void 0===n&&(n="roledefinitions"),e.call(this,t,n)}return r(t,e),t.prototype.getById=function(e){return new l(this,"getById("+e+")")},t.prototype.getByName=function(e){return new l(this,"getbyname('"+e+"')")},t.prototype.getByType=function(e){return new l(this,"getbytype("+e+")")},t.prototype.add=function(e,t,n,r){var o=this,i=JSON.stringify({BasePermissions:a.Util.extend({__metadata:{type:"SP.BasePermissions"}},r),Description:t,Name:e,Order:n,__metadata:{type:"SP.RoleDefinition"}});return this.post({body:i}).then(function(e){return{data:e,definition:o.getById(e.Id)}})},t}(o.QueryableCollection);n.RoleDefinitions=c;var l=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),t.prototype.update=function(e){var t=this;"undefined"!=typeof e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=a.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var n=JSON.stringify(a.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var r=t;if(e.hasOwnProperty("Name")){var o=t.getParent(c,t.parentUrl,"");r=o.getByName(e.Name)}return{data:n,definition:r}})},t.prototype.delete=function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.QueryableInstance);n.RoleDefinition=l;var p=function(e){function t(t,n){void 0===n&&(n="roledefinitionbindings"),e.call(this,t,n)}return r(t,e),t}(o.QueryableCollection);n.RoleDefinitionBindings=p},{"../../utils/util":45,"./queryable":24,"./sitegroups":32}],29:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("../../utils/util"),a=function(e){function t(t,n){void 0===n&&(n="_api/search/postquery"),e.call(this,t,n)}return r(t,e),t.prototype.execute=function(e){var t;t=e,t.SelectProperties&&(t.SelectProperties={results:e.SelectProperties}),t.RefinementFilters&&(t.RefinementFilters={results:e.RefinementFilters}),t.SortList&&(t.SortList={results:e.SortList}),t.HithighlightedProperties&&(t.HithighlightedProperties={results:e.HithighlightedProperties}),t.ReorderingRules&&(t.ReorderingRules={results:e.ReorderingRules}),t.Properties&&(t.Properties={results:e.Properties});var n=JSON.stringify({request:i.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.post({body:n}).then(function(e){return new s(e)})},t}(o.QueryableInstance);n.Search=a;var s=function(){function e(e){var t=e.postquery?e.postquery:e;this.PrimarySearchResults=this.formatSearchResults(t.PrimaryQueryResult.RelevantResults.Table.Rows),this.RawSearchResults=t,this.ElapsedTime=t.ElapsedTime,this.RowCount=t.PrimaryQueryResult.RelevantResults.RowCount,this.TotalRows=t.PrimaryQueryResult.RelevantResults.TotalRows,this.TotalRowsIncludingDuplicates=t.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates}return e.prototype.formatSearchResults=function(e){for(var t=new Array,n=e.results?e.results:e,r=0,o=n;r<o.length;r++){var i=o[r];t.push(new u(i.Cells))}return t},e}();n.SearchResults=s;var u=function(){function e(e){for(var t=e.results?e.results:e,n=0,r=t;n<r.length;n++){var o=r[n];this[o.Key]=o.Value}}return e}();n.SearchResult=u,function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(n.SortDirection||(n.SortDirection={}));n.SortDirection;!function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(n.ReorderingRuleMatchType||(n.ReorderingRuleMatchType={}));n.ReorderingRuleMatchType;!function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32TYpe=2]="Int32TYpe",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(n.QueryPropertyValueType||(n.QueryPropertyValueType={}));n.QueryPropertyValueType},{"../../utils/util":45,"./queryable":24}],30:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=function(e){function t(t,n){void 0===n&&(n="_api/search/suggest"),e.call(this,t,n)}return r(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new a(e)})},t.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},t}(o.QueryableInstance);n.SearchSuggest=i;var a=function(){function e(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}return e}();n.SearchSuggestResult=a},{"./queryable":24}],31:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./webs"),a=e("./usercustomactions"),s=e("./odata"),u=function(e){function t(t,n){void 0===n&&(n="_api/site"),e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new i.Web(this,"rootweb")},
enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new a.UserCustomActions(this)},enumerable:!0,configurable:!0}),t.prototype.getContextInfo=function(){var e=new t("","_api/contextinfo");return e.post().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new o.Queryable("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new o.Queryable("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new s.ODataBatch(this.parentUrl)},t}(o.QueryableInstance);n.Site=u},{"./odata":23,"./queryable":24,"./usercustomactions":37,"./webs":40}],32:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./siteusers"),a=e("../../utils/util");!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(n.PrincipalType||(n.PrincipalType={}));var s=(n.PrincipalType,function(e){function t(t,n){void 0===n&&(n="sitegroups"),e.call(this,t,n)}return r(t,e),t.prototype.add=function(e){var t=this,n=JSON.stringify(a.Util.extend({__metadata:{type:"SP.Group"}},e));return this.post({body:n}).then(function(e){return{data:e,group:t.getById(e.Id)}})},t.prototype.getByName=function(e){return new u(this,"getByName('"+e+"')")},t.prototype.getById=function(e){var t=new u(this);return t.concat("("+e+")"),t},t.prototype.removeById=function(e){var n=new t(this,"removeById('"+e+"')");return n.post()},t.prototype.removeByLoginName=function(e){var n=new t(this,"removeByLoginName('"+e+"')");return n.post()},t}(o.QueryableCollection));n.SiteGroups=s;var u=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"users",{get:function(){return new i.SiteUsers(this,"users")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var n=this,r=a.Util.extend({__metadata:{type:"SP.Group"}},e);return this.post({body:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE"}}).then(function(r){var o=n;return e.hasOwnProperty("Title")&&(o=n.getParent(t,n.parentUrl,"getByName('"+e.Title+"')")),{data:r,group:o}})},t}(o.QueryableInstance);n.SiteGroup=u},{"../../utils/util":45,"./queryable":24,"./siteusers":33}],33:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./sitegroups"),a=e("../../utils/util"),s=function(e){function t(t,n){void 0===n&&(n="siteusers"),e.call(this,t,n)}return r(t,e),t.prototype.getByEmail=function(e){return new u(this,"getByEmail('"+e+"')")},t.prototype.getById=function(e){return new u(this,"getById("+e+")")},t.prototype.getByLoginName=function(e){var t=new u(this);return t.concat("(@v)"),t.query.add("@v",encodeURIComponent(e)),t},t.prototype.removeById=function(e){var n=new t(this,"removeById("+e+")");return n.post()},t.prototype.removeByLoginName=function(e){var n=new t(this,"removeByLoginName(@v)");return n.query.add("@v",encodeURIComponent(e)),n.post()},t.prototype.add=function(e){var t=this,n=JSON.stringify({__metadata:{type:"SP.User"},LoginName:e});return this.post({body:n}).then(function(n){return t.getByLoginName(e)})},t}(o.QueryableCollection);n.SiteUsers=s;var u=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.SiteGroups(this,"groups")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,n=a.Util.extend({__metadata:{type:"SP.User"}},e);return this.post({body:JSON.stringify(n),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})},t.prototype.delete=function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.QueryableInstance);n.SiteUser=u},{"../../utils/util":45,"./queryable":24,"./sitegroups":32}],34:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=function(e){function t(t,n){void 0===n&&(n="subscriptions"),e.call(this,t,n)}return r(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,n){var r=this,o=JSON.stringify({resource:this.toUrl(),notificationUrl:e,expirationDateTime:t,clientState:n||"pnp-js-core-subscription"});return this.post({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r.getById(e.id)}})},t}(o.QueryableCollection);n.Subscriptions=i;var a=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),t.prototype.update=function(e){var t=this,n=JSON.stringify({expirationDateTime:e});return this.patch({body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},t.prototype.delete=function(){return e.prototype.delete.call(this)},t}(o.QueryableInstance);n.Subscription=a},{"./queryable":24}],35:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=function(e){function t(t){e.call(this,t,"TopNavigationBar")}return r(t,e),t}(o.QueryableInstance);n.TopNavigationBar=i},{"./queryable":24}],36:[function(e,t,n){"use strict";!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(n.ControlMode||(n.ControlMode={}));n.ControlMode;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(n.FieldTypes||(n.FieldTypes={}));n.FieldTypes;!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(n.DateTimeFieldFormatType||(n.DateTimeFieldFormatType={}));n.DateTimeFieldFormatType;!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(n.AddFieldOptions||(n.AddFieldOptions={}));n.AddFieldOptions;!function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(n.CalendarType||(n.CalendarType={}));n.CalendarType;!function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(n.UrlFieldFormatType||(n.UrlFieldFormatType={}));n.UrlFieldFormatType;!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(n.PrincipalType||(n.PrincipalType={}));n.PrincipalType;!function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(n.PageType||(n.PageType={}));n.PageType},{}],37:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("../../utils/util"),a=function(e){function t(t,n){void 0===n&&(n="usercustomactions"),e.call(this,t,n)}return r(t,e),t.prototype.getById=function(e){return new s(this,"("+e+")")},t.prototype.add=function(e){var t=this,n=JSON.stringify(i.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.post({body:n}).then(function(e){return{action:t.getById(e.Id),data:e}})},t.prototype.clear=function(){var e=new t(this,"clear");return e.post()},t}(o.QueryableCollection);n.UserCustomActions=a;var s=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),t.prototype.update=function(e){var t=this,n=JSON.stringify(i.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})},t}(o.QueryableInstance);n.UserCustomAction=s},{"../../utils/util":45,"./queryable":24}],38:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("../../utils/files"),a=e("./odata"),s=function(e){function t(t,n){void 0===n&&(n="_api/sp.userprofiles.peoplemanager"),e.call(this,t,n),this.profileLoader=new u(t)}return r(t,e),Object.defineProperty(t.prototype,"editProfileLink",{get:function(){var e=new t(this,"EditProfileLink");return e.getAs(a.ODataValue())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMyPeopleListPublic",{get:function(){var e=new t(this,"IsMyPeopleListPublic");return e.getAs(a.ODataValue())},enumerable:!0,configurable:!0}),t.prototype.amIFollowedBy=function(e){var n=new t(this,"amifollowedby(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.amIFollowing=function(e){var n=new t(this,"amifollowing(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getFollowedTags=function(e){void 0===e&&(e=20);var n=new t(this,"getfollowedtags("+e+")");return n.get()},t.prototype.getFollowersFor=function(e){var n=new t(this,"getfollowersfor(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"myFollowers",{get:function(){return new o.QueryableCollection(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myProperties",{get:function(){return new t(this,"getmyproperties")},enumerable:!0,configurable:!0}),t.prototype.getPeopleFollowedBy=function(e){var n=new t(this,"getpeoplefollowedby(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getPropertiesFor=function(e){var n=new t(this,"getpropertiesfor(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"trendingTags",{get:function(){var e=new t(this,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),t.prototype.getUserProfilePropertyFor=function(e,n){var r=new t(this,"getuserprofilepropertyfor(accountname=@v, propertyname='"+n+"')");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.hideSuggestion=function(e){var n=new t(this,"hidesuggestion(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.post()},t.prototype.isFollowing=function(e,n){var r=new t(this,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.query.add("@y","'"+encodeURIComponent(n)+"'"),r.get()},t.prototype.setMyProfilePic=function(e){var n=this;return i.readBlobAsArrayBuffer(e).then(function(e){var r=new t(n,"setmyprofilepicture");return r.post({body:String.fromCharCode.apply(null,new Uint16Array(e))})})},t.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},t.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},t}(o.QueryableInstance);n.UserProfileQuery=s;var u=function(e){function t(t,n){void 0===n&&(n="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,n)}return r(t,e),t.prototype.createPersonalSiteEnqueueBulk=function(e){var n=new t(this,"createpersonalsiteenqueuebulk"),r=JSON.stringify({emailIDs:e});return n.post({body:r})},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(t,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return e.postAs()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){var e=new t(this,"getuserprofile");return e.postAs()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){void 0===e&&(e=!1);var n=new t(this,"getuserprofile/createpersonalsiteenque("+e+')",');return n.post()},t.prototype.shareAllSocialData=function(e){var n=new t(this,"getuserprofile/shareallsocialdata("+e+')",');return n.post()},t}(o.Queryable)},{"../../utils/files":42,"./odata":23,"./queryable":24}],39:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("../../utils/util"),a=function(e){function t(t){e.call(this,t,"views")}return r(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new s(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,t,n){var r=this;void 0===t&&(t=!1),void 0===n&&(n={});var o=JSON.stringify(i.Util.extend({__metadata:{type:"SP.View"},Title:e,PersonalView:t},n));return this.postAs({body:o}).then(function(e){return{data:e,view:r.getById(e.Id)}})},t}(o.QueryableCollection);n.Views=a;var s=function(e){function t(t,n){e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,n=JSON.stringify(i.Util.extend({__metadata:{type:"SP.View"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})},t.prototype.delete=function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.renderAsHtml=function(){var e=new o.Queryable(this,"renderashtml");return e.get()},t}(o.QueryableInstance);n.View=s;var u=function(e){function t(t,n){void 0===n&&(n="viewfields"),e.call(this,t,n)}return r(t,e),t.prototype.getSchemaXml=function(){var e=new o.Queryable(this,"schemaxml");return e.get()},t.prototype.add=function(e){var n=new t(this,"addviewfield('"+e+"')");return n.post()},t.prototype.move=function(e,n){var r=new t(this,"moveviewfieldto"),o=JSON.stringify({field:e,index:n});return r.post({body:o})},t.prototype.removeAll=function(){var e=new t(this,"removeallviewfields");return e.post()},t.prototype.remove=function(e){var n=new t(this,"removeviewfield('"+e+"')");return n.post()},t}(o.QueryableCollection);n.ViewFields=u},{"../../utils/util":45,"./queryable":24}],40:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./queryable"),i=e("./queryablesecurable"),a=e("./lists"),s=e("./fields"),u=e("./navigation"),c=e("./sitegroups"),l=e("./contenttypes"),p=e("./folders"),f=e("./roles"),d=e("./files"),h=e("../../utils/util"),y=e("./lists"),g=e("./siteusers"),b=e("./usercustomactions"),v=e("./odata"),m=function(e){function t(t,n){void 0===n&&(n="webs"),e.call(this,t,n)}return r(t,e),t.prototype.add=function(e,n,r,o,i,a,s){void 0===r&&(r=""),void 0===o&&(o="STS"),void 0===i&&(i=1033),void 0===a&&(a=!0),void 0===s&&(s={});var u=h.Util.extend({Description:r,Language:i,Title:e,Url:n,UseSamePermissionsAsParentSite:a,WebTemplate:o},s),c=JSON.stringify({parameters:h.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},u)}),l=new t(this,"add");return l.post({body:c}).then(function(e){return{data:e,web:new w(v.extractOdataId(e),"")}})},t}(o.QueryableCollection);n.Webs=m;var w=function(e){function t(t,n){void 0===n&&(n="_api/web"),e.call(this,t,n)}return r(t,e),Object.defineProperty(t.prototype,"webs",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new l.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lists",{get:function(){return new a.Lists(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new s.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availablefields",{get:function(){return new s.Fields(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigation",{get:function(){return new u.Navigation(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUsers",{get:function(){return new g.SiteUsers(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteGroups",{get:function(){return new c.SiteGroups(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new p.Folders(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new b.UserCustomActions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleDefinitions",{get:function(){return new f.RoleDefinitions(this)},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new v.ODataBatch(this.parentUrl)},t.prototype.getFolderByServerRelativeUrl=function(e){return new p.Folder(this,"getFolderByServerRelativeUrl('"+e+"')")},t.prototype.getFileByServerRelativeUrl=function(e){return new d.File(this,"getFileByServerRelativeUrl('"+e+"')")},t.prototype.getList=function(e){return new y.List(this,"getList('"+e+"')")},t.prototype.update=function(e){var t=this,n=JSON.stringify(h.Util.extend({__metadata:{type:"SP.Web"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},t.prototype.delete=function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.applyTheme=function(e,n,r,o){var i=JSON.stringify({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:n,shareGenerated:o}),a=new t(this,"applytheme");return a.post({body:i})},t.prototype.applyWebTemplate=function(e){var n=new t(this,"applywebtemplate");return n.concat("(@t)"),n.query.add("@t",e),n.post()},t.prototype.doesUserHavePermissions=function(e){var n=new t(this,"doesuserhavepermissions");return n.concat("(@p)"),n.query.add("@p",JSON.stringify(e)),n.get()},t.prototype.ensureUser=function(e){var n=JSON.stringify({logonName:e}),r=new t(this,"ensureuser");return r.post({body:n})},t.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new o.QueryableCollection(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},t.prototype.getCatalog=function(e){var n=new t(this,"getcatalog("+e+")");return n.select("Id"),n.get().then(function(e){return new y.List(v.extractOdataId(e))})},t.prototype.getChanges=function(e){var n=JSON.stringify({query:h.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)}),r=new t(this,"getchanges");return r.post({body:n})},Object.defineProperty(t.prototype,"customListTemplate",{get:function(){return new o.QueryableCollection(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),t.prototype.getUserById=function(e){return new g.SiteUser(this,"getUserById("+e+")")},t.prototype.mapToIcon=function(e,n,r){void 0===n&&(n=0),void 0===r&&(r="");var o=new t(this,"maptoicon(filename='"+e+"', progid='"+r+"', size="+n+")");return o.get()},t}(i.QueryableSecurable);n.Web=w},{"../../utils/util":45,"./contenttypes":14,"./fields":15,"./files":16,"./folders":17,"./lists":21,"./navigation":22,"./odata":23,"./queryable":24,"./queryablesecurable":25,"./roles":28,"./sitegroups":32,"./siteusers":33,"./usercustomactions":37}],41:[function(e,t,n){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}r(e("../sharepoint/rest/index"));var o=e("../net/httpclient");n.HttpClient=o.HttpClient;var i=e("../collections/collections");n.Dictionary=i.Dictionary;var a=e("../utils/util");n.Util=a.Util,r(e("../utils/logging"))},{"../collections/collections":1,"../net/httpclient":9,"../sharepoint/rest/index":19,"../utils/logging":43,"../utils/util":45}],42:[function(e,t,n){"use strict";function r(e){return i(e,"string")}function o(e){return i(e,"buffer")}function i(e,t){return new Promise(function(n,r){var o=new FileReader;switch(o.onload=function(e){n(e.target.result)},t){case"string":o.readAsText(e);break;case"buffer":o.readAsArrayBuffer(e)}})}n.readBlobAsText=r,n.readBlobAsArrayBuffer=o},{}],43:[function(e,t,n){"use strict";!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(n.LogLevel||(n.LogLevel={}));var r=n.LogLevel,o=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return"undefined"!=typeof e._instance&&null!==e._instance||(e._instance=new i),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];for(var r=0;r<t.length;r++)e.instance.subscribe(t[r])},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=r.Verbose),e.instance.log({level:n,message:t})},e.log=function(t){e.instance.log(t)},e.measure=function(t,n){return e.instance.measure(t,n)},e}();n.Logger=o;var i=function(){function e(e,t){void 0===e&&(e=r.Warning),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=r.Verbose),this.log({level:t,message:e})},e.prototype.log=function(e){if(!("undefined"==typeof e||e.level<this.activeLogLevel))for(var t=0;t<this.subscribers.length;t++)this.subscribers[t].log(e)},e.prototype.measure=function(e,t){console.profile(e);try{return t()}finally{console.profileEnd()}},e}(),a=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case r.Verbose:case r.Info:console.log(t);break;case r.Warning:console.warn(t);break;case r.Error:console.error(t)}},e.prototype.format=function(e){return"Message: "+e.message+". Data: "+JSON.stringify(e.data)},e}();n.ConsoleListener=a;var s=function(){function e(e){this.azureInsightsInstrumentationKey=e;var t=window.appInsights||function(e){function t(e){o[e]=function(){var t=arguments;o.queue.push(function(){o[e].apply(o,t)})}}var n,r,o={config:e},i=document,a=window,s="script",u=i.createElement(s);for(u.src=e.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",i.getElementsByTagName(s)[0].parentNode.appendChild(u),o.cookie=i.cookie,o.queue=[],n=["Event","Exception","Metric","PageView","Trace"];n.length;)t("track"+n.pop());return t("setAuthenticatedUserContext"),t("clearAuthenticatedUserContext"),e.disableExceptionTracking||(n="onerror",t("_"+n),r=a[n],a[n]=function(e,t,i,a,s){var u=r&&r(e,t,i,a,s);return u!==!0&&o["_"+n](e,t,i,a,s),u}),o}({instrumentationKey:this.azureInsightsInstrumentationKey});window.appInsights=t}return e.prototype.log=function(e){var t=window.appInsights,n=this.format(e);e.level===r.Error?t.trackException(n):t.trackEvent(n)},e.prototype.format=function(e){return"Message: "+e.message+". Data: "+JSON.stringify(e.data)},e}();n.AzureInsightsListener=s;var u=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}();n.FunctionListener=u},{}],44:[function(e,t,n){"use strict";var r=e("./util"),o=function(){function e(e,t){this.store=e,this.defaultTimeoutMinutes=t,this.defaultTimeoutMinutes=void 0===t?5:t,this.enabled=this.test()}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(null==t)return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var o=this;if(!this.enabled)return t();if(!r.Util.isFunction(t))throw"Function expected for parameter 'getter'.";return new Promise(function(r,i){var a=o.get(e);null==a?t().then(function(t){o.put(e,t,n),r(t)}):r(a)})},e.prototype.test=function(){var e="test";try{return this.store.setItem(e,e),this.store.removeItem(e),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){return"undefined"==typeof t&&(t=r.Util.dateAdd(new Date,"minute",this.defaultTimeoutMinutes)),JSON.stringify({expiration:t,value:e})},e}();n.PnPClientStorageWrapper=o;var i=function(){function e(){this.local="undefined"!=typeof localStorage?new o(localStorage):null,this.session="undefined"!=typeof sessionStorage?new o(sessionStorage):null}return e}();n.PnPClientStorage=i},{"./util":45}],45:[function(e,t,n){(function(e){"use strict";var t=function(){function t(){}return t.getCtxCallback=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}},t.urlParamExists=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)");return t.test(location.search)},t.getUrlParamByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))},t.getUrlParamBoolByName=function(e){var t=this.getUrlParamByName(e),n=""===t||/false|0/i.test(t);return!n},t.stringInsert=function(e,t,n){return t>0?e.substring(0,t)+n+e.substring(t,e.length):n+e},t.dateAdd=function(e,t,n){var r=new Date(e.toLocaleString());switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r},t.loadStylesheet=function(e,t){t&&(e+="?"+encodeURIComponent((new Date).getTime().toString()));var n=document.getElementsByTagName("head");if(n.length>0){var r=document.createElement("link");n[0].appendChild(r),r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",e)}},t.combinePaths=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];for(var n=[],r=0;r<e.length;r++)"undefined"!=typeof e[r]&&null!==e[r]&&n.push(e[r].replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,""));return n.join("/").replace(/\\/,"/")},t.getRandomString=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},t.getGUID=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)});return t},t.isFunction=function(e){return"function"==typeof e},t.isArray=function(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array},t.stringIsNullOrEmpty=function(e){return"undefined"==typeof e||null===e||""===e},t.extend=function(e,t,n){void 0===n&&(n=!1);var r={};for(var o in e)r[o]=e[o];var i=n?function(e,t){return!e.hasOwnProperty(t)}:function(e,t){return!0};for(var o in t)i(r,o)&&(r[o]=t[o]);return r},t.applyMixins=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(n){e.prototype[n]=t.prototype[n]})})},t.isUrlAbsolute=function(e){return/^https?:\/\/|^\/\//i.test(e)},t.makeUrlAbsolute=function(n){return t.isUrlAbsolute(n)?n:"undefined"==typeof e._spPageContextInfo?n:e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl")?t.combinePaths(e._spPageContextInfo.webAbsoluteUrl,n):e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl")?t.combinePaths(e._spPageContextInfo.webServerRelativeUrl,n):void 0},t}();n.Util=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[12])(12)});
//# sourceMappingURL=pnp.min.js.map
