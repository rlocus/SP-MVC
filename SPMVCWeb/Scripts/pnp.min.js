!function (e, t) { "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == typeof exports ? exports.$pnp = t() : e.$pnp = t() }(this, function () { return function (e) { function t(r) { if (n[r]) return n[r].exports; var o = n[r] = { i: r, l: !1, exports: {} }; return e[r].call(o.exports, o, o.exports, t), o.l = !0, o.exports } var n = {}; return t.m = e, t.c = n, t.i = function (e) { return e }, t.d = function (e, n, r) { t.o(e, n) || Object.defineProperty(e, n, { configurable: !1, enumerable: !0, get: r }) }, t.n = function (e) { var n = e && e.__esModule ? function () { return e.default } : function () { return e }; return t.d(n, "a", n), n }, t.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, t.p = "/assets/", t(t.s = 49) }([function (e, t, n) { "use strict"; (function (e) { var r = this && this.__decorate || function (e, t, n, r) { var o, i = arguments.length, a = i < 3 ? t : null === r ? r = Object.getOwnPropertyDescriptor(t, n) : r; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) a = Reflect.decorate(e, t, n, r); else for (var u = e.length - 1; u >= 0; u--) (o = e[u]) && (a = (i < 3 ? o(a) : i > 3 ? o(t, n, a) : o(t, n)) || a); return i > 3 && a && Object.defineProperty(t, n, a), a }; Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(47), i = n(4), a = function () { function t() { } return t.getCtxCallback = function (e, t) { for (var n = [], r = 2; r < arguments.length; r++) n[r - 2] = arguments[r]; return function () { t.apply(e, n) } }, t.urlParamExists = function (e) { return e = e.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]"), new RegExp("[\\?&]" + e + "=([^&#]*)").test(location.search) }, t.getUrlParamByName = function (e) { e = e.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]"); var t = new RegExp("[\\?&]" + e + "=([^&#]*)"), n = t.exec(location.search); return null == n ? "" : decodeURIComponent(n[1].replace(/\+/g, " ")) }, t.getUrlParamBoolByName = function (e) { var t = this.getUrlParamByName(e); return !("" === t || /false|0/i.test(t)) }, t.stringInsert = function (e, t, n) { return t > 0 ? e.substring(0, t) + n + e.substring(t, e.length) : n + e }, t.dateAdd = function (e, t, n) { var r = new Date(e.toLocaleString()); switch (t.toLowerCase()) { case "year": r.setFullYear(r.getFullYear() + n); break; case "quarter": r.setMonth(r.getMonth() + 3 * n); break; case "month": r.setMonth(r.getMonth() + n); break; case "week": r.setDate(r.getDate() + 7 * n); break; case "day": r.setDate(r.getDate() + n); break; case "hour": r.setTime(r.getTime() + 36e5 * n); break; case "minute": r.setTime(r.getTime() + 6e4 * n); break; case "second": r.setTime(r.getTime() + 1e3 * n); break; default: r = void 0 } return r }, t.loadStylesheet = function (e, t) { t && (e += "?" + encodeURIComponent((new Date).getTime().toString())); var n = document.getElementsByTagName("head"); if (n.length > 0) { var r = document.createElement("link"); n[0].appendChild(r), r.setAttribute("type", "text/css"), r.setAttribute("rel", "stylesheet"), r.setAttribute("href", e) } }, t.combinePaths = function () { for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t]; return e.filter(function (e) { return void 0 !== e && null !== e }).map(function (e) { return e.replace(/^[\\|\/]/, "").replace(/[\\|\/]$/, "") }).join("/").replace(/\\/g, "/") }, t.getRandomString = function (e) { for (var t = new Array(e), n = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", r = 0; r < e; r++) t[r] = n.charAt(Math.floor(Math.random() * n.length)); return t.join("") }, t.getGUID = function () { var e = (new Date).getTime(); return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (t) { var n = (e + 16 * Math.random()) % 16 | 0; return e = Math.floor(e / 16), ("x" === t ? n : 3 & n | 8).toString(16) }) }, t.isFunction = function (e) { return "function" == typeof e }, t.isArray = function (e) { return Array.isArray ? Array.isArray(e) : e && "number" == typeof e.length && e.constructor === Array }, t.stringIsNullOrEmpty = function (e) { return void 0 === e || null === e || "" === e }, t.extend = function (e, t, n) { if (void 0 === n && (n = !1), null === t || void 0 === t) return e; var r = n ? function (e, t) { return !(t in e) } : function () { return !0 }; return Object.getOwnPropertyNames(t).filter(function (t) { return r(e, t) }).reduce(function (e, n) { return e[n] = t[n], e }, e) }, t.isUrlAbsolute = function (e) { return /^https?:\/\/|^\/\//i.test(e) }, t.makeUrlAbsolute = function (n) { return t.isUrlAbsolute(n) ? n : void 0 === e._spPageContextInfo ? n : e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl") ? t.combinePaths(e._spPageContextInfo.webAbsoluteUrl, n) : e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl") ? t.combinePaths(e._spPageContextInfo.webServerRelativeUrl, n) : void 0 }, t.toAbsoluteUrl = function (n) { return new Promise(function (r) { if (t.isUrlAbsolute(n)) return r(n); if (null !== i.RuntimeConfig.baseUrl) return r(t.combinePaths(i.RuntimeConfig.baseUrl, n)); if (void 0 !== e._spPageContextInfo) { if (e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl")) return r(t.combinePaths(e._spPageContextInfo.webAbsoluteUrl, n)); if (e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl")) return r(t.combinePaths(e._spPageContextInfo.webServerRelativeUrl, n)) } if (void 0 !== e.location) { var o = e.location.toString().toLowerCase().indexOf("/_layouts/"); if (o > 0) return r(t.combinePaths(e.location.toString().substr(0, o), n)) } return r(n) }) }, t }(); r([o.deprecated("The Util.makeUrlAbsolute method is deprecated and will be removed from future releases. Use Util.toAbsoluteUrl instead")], a, "makeUrlAbsolute", null), t.Util = a }).call(t, n(30)) }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(0), i = n(6), a = n(3), u = n(4), s = n(2), c = n(42), l = function () { function e(e, t) { if (this._query = new i.Dictionary, this._batch = null, "string" == typeof e) { var n = e; if (o.Util.isUrlAbsolute(n) || n.lastIndexOf("/") < 0) this._parentUrl = n, this._url = o.Util.combinePaths(n, t); else if (n.lastIndexOf("/") > n.lastIndexOf("(")) { var r = n.lastIndexOf("/"); this._parentUrl = n.slice(0, r), t = o.Util.combinePaths(n.slice(r), t), this._url = o.Util.combinePaths(this._parentUrl, t) } else { var r = n.lastIndexOf("("); this._parentUrl = n.slice(0, r), this._url = o.Util.combinePaths(n, t) } } else { var a = e; this._parentUrl = a._url; var u = a._query.get("@target"); null !== u && this._query.add("@target", u), this._url = o.Util.combinePaths(this._parentUrl, t) } } return e.prototype.concat = function (e) { this._url += e }, e.prototype.append = function (e) { this._url = o.Util.combinePaths(this._url, e) }, e.prototype.addBatchDependency = function () { return this.hasBatch ? this._batch.addDependency() : function () { return null } }, Object.defineProperty(e.prototype, "hasBatch", { get: function () { return null !== this._batch }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "parentUrl", { get: function () { return this._parentUrl }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "query", { get: function () { return this._query }, enumerable: !0, configurable: !0 }), e.prototype.as = function (e) { var t = new e(this._url, null); return o.Util.extend(t, this, !0) }, e.prototype.inBatch = function (e) { if (null !== this._batch) throw new s.AlreadyInBatchException; return this._batch = e, this }, e.prototype.usingCaching = function (e) { return u.RuntimeConfig.globalCacheDisable || (this._useCaching = !0, this._cachingOptions = e), this }, e.prototype.toUrl = function () { return this._url }, e.prototype.toUrlAndQuery = function () { var e = this, t = this.toUrl(); return this._query.count() > 0 && (t += "?" + this._query.getKeys().map(function (t) { return t + "=" + e._query.get(t) }).join("&")), t }, e.prototype.getParent = function (e, t, n) { void 0 === t && (t = this.parentUrl); var r = new e(t, n), o = this.query.get("@target"); return null !== o && r.query.add("@target", o), r }, e.prototype.get = function (e, t) { return void 0 === e && (e = new a.ODataDefaultParser), void 0 === t && (t = {}), this.toRequestContext("GET", t, e).then(function (e) { return c.pipe(e) }) }, e.prototype.getAs = function (e, t) { return void 0 === e && (e = new a.ODataDefaultParser), void 0 === t && (t = {}), this.toRequestContext("GET", t, e).then(function (e) { return c.pipe(e) }) }, e.prototype.post = function (e, t) { return void 0 === e && (e = {}), void 0 === t && (t = new a.ODataDefaultParser), this.toRequestContext("POST", e, t).then(function (e) { return c.pipe(e) }) }, e.prototype.postAs = function (e, t) { return void 0 === e && (e = {}), void 0 === t && (t = new a.ODataDefaultParser), this.toRequestContext("POST", e, t).then(function (e) { return c.pipe(e) }) }, e.prototype.patch = function (e, t) { return void 0 === e && (e = {}), void 0 === t && (t = new a.ODataDefaultParser), this.toRequestContext("PATCH", e, t).then(function (e) { return c.pipe(e) }) }, e.prototype.delete = function (e, t) { return void 0 === e && (e = {}), void 0 === t && (t = new a.ODataDefaultParser), this.toRequestContext("DELETE", e, t).then(function (e) { return c.pipe(e) }) }, e.prototype.toRequestContext = function (e, t, n) { var r = this; void 0 === t && (t = {}); var i = this.hasBatch ? this.addBatchDependency() : function () { }; return o.Util.toAbsoluteUrl(this.toUrlAndQuery()).then(function (a) { return { batch: r._batch, batchDependency: i, cachingOptions: r._cachingOptions, isBatched: r.hasBatch, isCached: r._useCaching, options: t, parser: n, requestAbsoluteUrl: a, requestId: o.Util.getGUID(), verb: e } }) }, e }(); t.Queryable = l; var p = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r(t, e), t.prototype.filter = function (e) { return this._query.add("$filter", e), this }, t.prototype.select = function () { for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t]; return this._query.add("$select", e.join(",")), this }, t.prototype.expand = function () { for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t]; return this._query.add("$expand", e.join(",")), this }, t.prototype.orderBy = function (e, t) { void 0 === t && (t = !0); for (var n = this._query.getKeys(), r = [], o = t ? " asc" : " desc", i = 0; i < n.length; i++) if ("$orderby" === n[i]) { r.push(this._query.get("$orderby")); break } return r.push("" + e + o), this._query.add("$orderby", r.join(",")), this }, t.prototype.skip = function (e) { return this._query.add("$skip", e.toString()), this }, t.prototype.top = function (e) { return this._query.add("$top", e.toString()), this }, t }(l); t.QueryableCollection = p; var f = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r(t, e), t.prototype.select = function () { for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t]; return this._query.add("$select", e.join(",")), this }, t.prototype.expand = function () { for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t]; return this._query.add("$expand", e.join(",")), this }, t }(l); t.QueryableInstance = f }, function (e, t, n) { "use strict"; function r(e) { i.Logger.log({ data: {}, level: i.LogLevel.Error, message: "[" + e.name + "]::" + e.message }) } var o = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(5), a = function (e) { function t(t, n, r) { var o = e.call(this, "Error making HttpClient request in queryable: [" + t + "] " + n) || this; return o.status = t, o.statusText = n, o.data = r, o.name = "ProcessHttpClientResponseException", i.Logger.log({ data: o.data, level: i.LogLevel.Error, message: o.message }), o } return o(t, e), t }(Error); t.ProcessHttpClientResponseException = a; var u = function (e) { function t(t) { void 0 === t && (t = "Cannot create a caching configuration provider since cache is not available."); var n = e.call(this, t) || this; return n.name = "NoCacheAvailableException", r(n), n } return o(t, e), t }(Error); t.NoCacheAvailableException = u; var s = function (e) { function t(t) { void 0 === t && (t = "Unable to determine API url."); var n = e.call(this, t) || this; return n.name = "APIUrlException", r(n), n } return o(t, e), t }(Error); t.APIUrlException = s; var c = function (e) { function t(t, n) { void 0 === n && (n = "Auth URL Endpoint could not be determined from data. Data logged."); var r = e.call(this, n) || this; return r.name = "APIUrlException", i.Logger.log({ data: t, level: i.LogLevel.Error, message: r.message }), r } return o(t, e), t }(Error); t.AuthUrlException = c; var l = function (e) { function t(t) { void 0 === t && (t = "Using NodeFetchClient in the browser is not supported."); var n = e.call(this, t) || this; return n.name = "NodeFetchClientUnsupportedException", r(n), n } return o(t, e), t }(Error); t.NodeFetchClientUnsupportedException = l; var p = function (e) { function t() { var t = this, n = ["SP.RequestExecutor is undefined. ", "Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" "); return t = e.call(this, n) || this, t.name = "SPRequestExecutorUndefinedException", r(t), t } return o(t, e), t }(Error); t.SPRequestExecutorUndefinedException = p; var f = function (e) { function t(t) { void 0 === t && (t = "The maximum comment length is 1023 characters."); var n = e.call(this, t) || this; return n.name = "MaxCommentLengthException", r(n), n } return o(t, e), t }(Error); t.MaxCommentLengthException = f; var d = function (e) { function t(t) { void 0 === t && (t = "This operation"); var n = e.call(this, t + " is not supported as part of a batch.") || this; return n.name = "NotSupportedInBatchException", r(n), n } return o(t, e), t }(Error); t.NotSupportedInBatchException = d; var h = function (e) { function t(t, n) { void 0 === n && (n = "Could not extract odata id in object, you may be using nometadata. Object data logged to logger."); var r = e.call(this, n) || this; return r.name = "ODataIdException", i.Logger.log({ data: t, level: i.LogLevel.Error, message: r.message }), r } return o(t, e), t }(Error); t.ODataIdException = h; var y = function (e) { function t(t) { var n = e.call(this, t) || this; return n.name = "BatchParseException", r(n), n } return o(t, e), t }(Error); t.BatchParseException = y; var g = function (e) { function t(t) { void 0 === t && (t = "This query is already part of a batch."); var n = e.call(this, t) || this; return n.name = "AlreadyInBatchException", r(n), n } return o(t, e), t }(Error); t.AlreadyInBatchException = g; var v = function (e) { function t(t) { void 0 === t && (t = "This query is already part of a batch."); var n = e.call(this, t) || this; return n.name = "FunctionExpectedException", r(n), n } return o(t, e), t }(Error); t.FunctionExpectedException = v; var b = function (e) { function t(t) { var n = e.call(this, t) || this; return n.name = "UrlException", r(n), n } return o(t, e), t }(Error); t.UrlException = b }, function (e, t, n) { "use strict"; function r(e) { if (e.hasOwnProperty("odata.id")) return e["odata.id"]; if (e.hasOwnProperty("__metadata") && e.__metadata.hasOwnProperty("id")) return e.__metadata.id; throw new d.ODataIdException(e) } function o(e) { return e.hasOwnProperty("odata.editLink") ? c.Util.combinePaths("_api", e["odata.editLink"]) : e.hasOwnProperty("__metadata") ? e.__metadata.uri : (l.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.", l.LogLevel.Warning), "") } function i() { return new b } function a(e) { return new m(e) } function u(e) { return new w(e) } var s = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var c = n(0), l = n(5), p = n(10), f = n(4), d = n(2), h = n(2); t.extractOdataId = r; var y = function () { function e() { } return e.prototype.parse = function (e) { var t = this; return new Promise(function (n, r) { t.handleError(e, r) && (e.headers.has("Content-Length") && 0 === parseFloat(e.headers.get("Content-Length")) || 204 === e.status ? n({}) : e.json().then(function (e) { return n(t.parseODataJSON(e)) })) }) }, e.prototype.handleError = function (e, t) { return e.ok || e.json().then(function (n) { var r = { responseBody: n, responseHeaders: e.headers }; t(new h.ProcessHttpClientResponseException(e.status, e.statusText, r)) }), e.ok }, e.prototype.parseODataJSON = function (e) { var t = e; return e.hasOwnProperty("d") ? t = e.d.hasOwnProperty("results") ? e.d.results : e.d : e.hasOwnProperty("value") && (t = e.value), t }, e }(); t.ODataParserBase = y; var g = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return s(t, e), t }(y); t.ODataDefaultParser = g; var v = function () { function e() { } return e.prototype.parse = function (e) { return e.json() }, e }(); t.ODataRawParserImpl = v; var b = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return s(t, e), t.prototype.parse = function (t) { return e.prototype.parse.call(this, t).then(function (e) { return e }) }, t }(y), m = function (e) { function t(t) { var n = e.call(this) || this; return n.factory = t, n } return s(t, e), t.prototype.parse = function (t) { var n = this; return e.prototype.parse.call(this, t).then(function (e) { var t = new n.factory(o(e), null); return c.Util.extend(t, e) }) }, t }(y), w = function (e) { function t(t) { var n = e.call(this) || this; return n.factory = t, n } return s(t, e), t.prototype.parse = function (t) { var n = this; return e.prototype.parse.call(this, t).then(function (e) { return e.map(function (e) { var t = new n.factory(o(e), null); return c.Util.extend(t, e) }) }) }, t }(y); t.ODataRaw = new v, t.ODataValue = i, t.ODataEntity = a, t.ODataEntityArray = u; var P = function () { function e(e, t) { void 0 === t && (t = c.Util.getGUID()), this.baseUrl = e, this._batchId = t, this._requests = [], this._dependencies = Promise.resolve() } return e.prototype.add = function (e, t, n, r) { var o = { method: t.toUpperCase(), options: n, parser: r, reject: null, resolve: null, url: e }, i = new Promise(function (e, t) { o.resolve = e, o.reject = t }); return this._requests.push(o), i }, e.prototype.addDependency = function () { var e, t = new Promise(function (t) { e = t }); return this._dependencies = this._dependencies.then(function () { return t }), e }, e.prototype.execute = function () { var e = this; return this._dependencies.then(function () { return e.executeImpl() }) }, e.prototype.executeImpl = function () { var e = this; if (l.Logger.write("Executing batch with " + this._requests.length + " requests.", l.LogLevel.Info), this._requests.length < 1) return l.Logger.write("Resolving empty batch.", l.LogLevel.Info), Promise.resolve(); var t = new p.HttpClient; return c.Util.toAbsoluteUrl(this.baseUrl).then(function (n) { var r = [], o = ""; e._requests.map(function (t) { "GET" === t.method ? (o.length > 0 && (r.push("--changeset_" + o + "--\n\n"), o = ""), r.push("--batch_" + e._batchId + "\n")) : (o.length < 1 && (o = c.Util.getGUID(), r.push("--batch_" + e._batchId + "\n"), r.push('Content-Type: multipart/mixed; boundary="changeset_' + o + '"\n\n')), r.push("--changeset_" + o + "\n")), r.push("Content-Type: application/http\n"), r.push("Content-Transfer-Encoding: binary\n\n"); var i = { Accept: "application/json;" }, a = c.Util.isUrlAbsolute(t.url) ? t.url : c.Util.combinePaths(n, t.url); if (l.Logger.write("Adding request " + t.method + " " + a + " to batch.", l.LogLevel.Verbose), "GET" !== t.method) { var u = t.method; t.hasOwnProperty("options") && t.options.hasOwnProperty("headers") && void 0 !== t.options.headers["X-HTTP-Method"] && (u = t.options.headers["X-HTTP-Method"], delete t.options.headers["X-HTTP-Method"]), r.push(u + " " + a + " HTTP/1.1\n"), i = c.Util.extend(i, { "Content-Type": "application/json;odata=verbose;charset=utf-8" }) } else r.push(t.method + " " + a + " HTTP/1.1\n"); void 0 !== f.RuntimeConfig.headers && (i = c.Util.extend(i, f.RuntimeConfig.headers)), t.options && t.options.headers && (i = c.Util.extend(i, t.options.headers)); for (var s in i) i.hasOwnProperty(s) && r.push(s + ": " + i[s] + "\n"); r.push("\n"), t.options.body && r.push(t.options.body + "\n\n") }), o.length > 0 && (r.push("--changeset_" + o + "--\n\n"), o = ""), r.push("--batch_" + e._batchId + "--\n"); var i = { "Content-Type": "multipart/mixed; boundary=batch_" + e._batchId }, a = { body: r.join(""), headers: i }; return l.Logger.write("Sending batch request.", l.LogLevel.Info), t.post(c.Util.combinePaths(n, "/_api/$batch"), a).then(function (e) { return e.text() }).then(e._parseResponse).then(function (t) { if (t.length !== e._requests.length) throw new d.BatchParseException("Could not properly parse responses to match requests in batch."); return l.Logger.write("Resolving batched requests.", l.LogLevel.Info), t.reduce(function (t, n, r) { var o = e._requests[r]; return l.Logger.write("Resolving request " + o.method + " " + o.url + ".", l.LogLevel.Verbose), t.then(function (e) { return o.parser.parse(n).then(o.resolve).catch(o.reject) }) }, Promise.resolve()) }) }) }, e.prototype._parseResponse = function (e) { return new Promise(function (t, n) { for (var r, o, i = [], a = "--batchresponse_", u = new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)", "i"), s = e.split("\n"), c = "batch", l = 0; l < s.length; ++l) { var p = s[l]; switch (c) { case "batch": if (p.substr(0, a.length) === a) c = "batchHeaders"; else if ("" !== p.trim()) throw new d.BatchParseException("Invalid response, line " + l); break; case "batchHeaders": "" === p.trim() && (c = "status"); break; case "status": var f = u.exec(p); if (3 !== f.length) throw new d.BatchParseException("Invalid status, line " + l); r = parseInt(f[1], 10), o = f[2], c = "statusHeaders"; break; case "statusHeaders": "" === p.trim() && (c = "body"); break; case "body": i.push(204 === r ? new Response : new Response(p, { status: r, statusText: o })), c = "batch" } } "status" !== c && n(new d.BatchParseException("Unexpected end of input")), t(i) }) }, e }(); t.ODataBatch = P; var _ = function () { function e() { } return e.prototype.parse = function (e) { return e.text() }, e }(); t.TextFileParser = _; var O = function () { function e() { } return e.prototype.parse = function (e) { return e.blob() }, e }(); t.BlobFileParser = O; var T = function () { function e() { } return e.prototype.parse = function (e) { return e.json() }, e }(); t.JSONFileParser = T; var S = function () { function e() { } return e.prototype.parse = function (e) { return c.Util.isFunction(e.arrayBuffer) ? e.arrayBuffer() : e.buffer() }, e }(); t.BufferFileParser = S }, function (e, t, n) { "use strict"; function r(e) { a.set(e) } Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(18), i = function () { function e() { this._headers = null, this._defaultCachingStore = "session", this._defaultCachingTimeoutSeconds = 30, this._globalCacheDisable = !1, this._fetchClientFactory = function () { return new o.FetchClient }, this._baseUrl = null, this._spfxContext = null } return e.prototype.set = function (e) { e.hasOwnProperty("headers") && (this._headers = e.headers), e.hasOwnProperty("globalCacheDisable") && (this._globalCacheDisable = e.globalCacheDisable), e.hasOwnProperty("defaultCachingStore") && (this._defaultCachingStore = e.defaultCachingStore), e.hasOwnProperty("defaultCachingTimeoutSeconds") && (this._defaultCachingTimeoutSeconds = e.defaultCachingTimeoutSeconds), e.hasOwnProperty("fetchClientFactory") && (this._fetchClientFactory = e.fetchClientFactory), e.hasOwnProperty("baseUrl") && (this._baseUrl = e.baseUrl), e.hasOwnProperty("spFXContext") && (this._spfxContext = e.spfxContext) }, Object.defineProperty(e.prototype, "headers", { get: function () { return this._headers }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "defaultCachingStore", { get: function () { return this._defaultCachingStore }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "defaultCachingTimeoutSeconds", { get: function () { return this._defaultCachingTimeoutSeconds }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "globalCacheDisable", { get: function () { return this._globalCacheDisable }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "fetchClientFactory", { get: function () { return this._fetchClientFactory }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "baseUrl", { get: function () { return null !== this._baseUrl ? this._baseUrl : null !== this._spfxContext ? this._spfxContext.pageContext.web.absoluteUrl : null }, enumerable: !0, configurable: !0 }), e }(); t.RuntimeConfigImpl = i; var a = new i; t.RuntimeConfig = a, t.setRuntimeConfig = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r; !function (e) { e[e.Verbose = 0] = "Verbose", e[e.Info = 1] = "Info", e[e.Warning = 2] = "Warning", e[e.Error = 3] = "Error", e[e.Off = 99] = "Off" }(r = t.LogLevel || (t.LogLevel = {})); var o = function () { function e() { } return Object.defineProperty(e, "activeLogLevel", { get: function () { return e.instance.activeLogLevel }, set: function (t) { e.instance.activeLogLevel = t }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "instance", { get: function () { return void 0 !== e._instance && null !== e._instance || (e._instance = new i), e._instance }, enumerable: !0, configurable: !0 }), e.subscribe = function () { for (var t = [], n = 0; n < arguments.length; n++) t[n] = arguments[n]; t.map(function (t) { return e.instance.subscribe(t) }) }, e.clearSubscribers = function () { return e.instance.clearSubscribers() }, Object.defineProperty(e, "count", { get: function () { return e.instance.count }, enumerable: !0, configurable: !0 }), e.write = function (t, n) { void 0 === n && (n = r.Verbose), e.instance.log({ level: n, message: t }) }, e.writeJSON = function (t, n) { void 0 === n && (n = r.Verbose), e.instance.log({ level: n, message: JSON.stringify(t) }) }, e.log = function (t) { e.instance.log(t) }, e.measure = function (t, n) { return e.instance.measure(t, n) }, e }(); t.Logger = o; var i = function () { function e(e, t) { void 0 === e && (e = r.Warning), void 0 === t && (t = []), this.activeLogLevel = e, this.subscribers = t } return e.prototype.subscribe = function (e) { this.subscribers.push(e) }, e.prototype.clearSubscribers = function () { var e = this.subscribers.slice(0); return this.subscribers.length = 0, e }, Object.defineProperty(e.prototype, "count", { get: function () { return this.subscribers.length }, enumerable: !0, configurable: !0 }), e.prototype.write = function (e, t) { void 0 === t && (t = r.Verbose), this.log({ level: t, message: e }) }, e.prototype.log = function (e) { void 0 === e || e.level < this.activeLogLevel || this.subscribers.map(function (t) { return t.log(e) }) }, e.prototype.measure = function (e, t) { console.profile(e); try { return t() } finally { console.profileEnd() } }, e }(), a = function () { function e() { } return e.prototype.log = function (e) { var t = this.format(e); switch (e.level) { case r.Verbose: case r.Info: console.log(t); break; case r.Warning: console.warn(t); break; case r.Error: console.error(t) } }, e.prototype.format = function (e) { return "Message: " + e.message + " Data: " + JSON.stringify(e.data) }, e }(); t.ConsoleListener = a; var u = function () { function e(e) { this.method = e } return e.prototype.log = function (e) { this.method(e) }, e }(); t.FunctionListener = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { void 0 === e && (e = []), void 0 === t && (t = []), this.keys = e, this.values = t } return e.prototype.get = function (e) { var t = this.keys.indexOf(e); return t < 0 ? null : this.values[t] }, e.prototype.add = function (e, t) { var n = this.keys.indexOf(e); n > -1 ? this.values[n] = t : (this.keys.push(e), this.values.push(t)) }, e.prototype.merge = function (e) { var t = this; if ("getKeys" in e) { var n = e; n.getKeys().map(function (e) { t.add(e, n.get(e)) }) } else { var r = e; for (var o in r) r.hasOwnProperty(o) && this.add(o, r[o]) } }, e.prototype.remove = function (e) { var t = this.keys.indexOf(e); if (t < 0) return null; var n = this.values[t]; return this.keys.splice(t, 1), this.values.splice(t, 1), n }, e.prototype.getKeys = function () { return this.keys }, e.prototype.getValues = function () { return this.values }, e.prototype.clear = function () { this.keys = [], this.values = [] }, e.prototype.count = function () { return this.keys.length }, e }(); t.Dictionary = r }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(3), a = n(0), u = n(2), s = n(46), c = function (e) { function t(t, n) { return void 0 === n && (n = "files"), e.call(this, t, n) || this } return r(t, e), t.prototype.getByName = function (e) { var t = new l(this); return t.concat("('" + e + "')"), t }, t.prototype.add = function (e, n, r) { var o = this; return void 0 === r && (r = !0), new t(this, "add(overwrite=" + r + ",url='" + e + "')").post({ body: n }).then(function (t) { return { data: t, file: o.getByName(e) } }) }, t.prototype.addChunked = function (e, n, r, o, i) { var a = this; return void 0 === o && (o = !0), void 0 === i && (i = 10485760), new t(this, "add(overwrite=" + o + ",url='" + e + "')").post().then(function () { return a.getByName(e) }).then(function (e) { return e.setContentChunked(n, r, i) }).then(function (t) { return { data: t, file: a.getByName(e) } }) }, t.prototype.addTemplateFile = function (e, n) { var r = this; return new t(this, "addTemplateFile(urloffile='" + e + "',templatefiletype=" + n + ")").post().then(function (t) { return { data: t, file: r.getByName(e) } }) }, t }(o.QueryableCollection); t.Files = c; var l = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "listItemAllFields", { get: function () { return new o.QueryableCollection(this, "listItemAllFields") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "versions", { get: function () { return new p(this) }, enumerable: !0, configurable: !0 }), t.prototype.approve = function (e) { return new t(this, "approve(comment='" + e + "')").post() }, t.prototype.cancelUpload = function (e) { return new t(this, "cancelUpload(uploadId=guid'" + e + "')").post() }, t.prototype.checkin = function (e, n) { return void 0 === e && (e = ""), void 0 === n && (n = d.Major), new t(this, "checkin(comment='" + e + "',checkintype=" + n + ")").post() }, t.prototype.checkout = function () { return new t(this, "checkout").post() }, t.prototype.copyTo = function (e, n) { return void 0 === n && (n = !0), new t(this, "copyTo(strnewurl='" + e + "',boverwrite=" + n + ")").post() }, t.prototype.delete = function (e) { return void 0 === e && (e = "*"), new t(this).post({ headers: { "IF-Match": e, "X-HTTP-Method": "DELETE" } }) }, t.prototype.deny = function (e) { return void 0 === e && (e = ""), new t(this, "deny(comment='" + e + "')").post() }, t.prototype.getLimitedWebPartManager = function (e) { return void 0 === e && (e = h.Shared), new s.LimitedWebPartManager(this, "getLimitedWebPartManager(scope=" + e + ")") }, t.prototype.moveTo = function (e, n) { return void 0 === n && (n = y.Overwrite), new t(this, "moveTo(newurl='" + e + "',flags=" + n + ")").post() }, t.prototype.publish = function (e) { return void 0 === e && (e = ""), new t(this, "publish(comment='" + e + "')").post() }, t.prototype.recycle = function () { return new t(this, "recycle").post() }, t.prototype.undoCheckout = function () { return new t(this, "undoCheckout").post() }, t.prototype.unpublish = function (e) { if (void 0 === e && (e = ""), e.length > 1023) throw new u.MaxCommentLengthException; return new t(this, "unpublish(comment='" + e + "')").post() }, t.prototype.getText = function () { return new t(this, "$value").get(new i.TextFileParser, { headers: { binaryStringResponseBody: "true" } }) }, t.prototype.getBlob = function () { return new t(this, "$value").get(new i.BlobFileParser, { headers: { binaryStringResponseBody: "true" } }) }, t.prototype.getBuffer = function () { return new t(this, "$value").get(new i.BufferFileParser, { headers: { binaryStringResponseBody: "true" } }) }, t.prototype.getJSON = function () { return new t(this, "$value").get(new i.JSONFileParser, { headers: { binaryStringResponseBody: "true" } }) }, t.prototype.setContent = function (e) { var n = this; return new t(this, "$value").post({ body: e, headers: { "X-HTTP-Method": "PUT" } }).then(function (e) { return new t(n) }) }, t.prototype.setContentChunked = function (e, t, n) { void 0 === n && (n = 10485760), void 0 === t && (t = function () { return null }); var r = this, o = e.size, i = parseInt((e.size / n).toString(), 10) + (e.size % n == 0 ? 1 : 0), u = a.Util.getGUID(); t({ blockNumber: 1, chunkSize: n, currentPointer: 0, fileSize: o, stage: "starting", totalBlocks: i }); for (var s = r.startUpload(u, e.slice(0, n)), c = function (a) { s = s.then(function (s) { return t({ blockNumber: a, chunkSize: n, currentPointer: s, fileSize: o, stage: "continue", totalBlocks: i }), r.continueUpload(u, s, e.slice(s, s + n)) }) }, l = 2; l < i; l++) c(l); return s.then(function (a) { return t({ blockNumber: i, chunkSize: n, currentPointer: a, fileSize: o, stage: "finishing", totalBlocks: i }), r.finishUpload(u, a, e.slice(a)) }).then(function (e) { return r }) }, t.prototype.startUpload = function (e, n) { return new t(this, "startUpload(uploadId=guid'" + e + "')").postAs({ body: n }).then(function (e) { return parseFloat(e) }) }, t.prototype.continueUpload = function (e, n, r) { return new t(this, "continueUpload(uploadId=guid'" + e + "',fileOffset=" + n + ")").postAs({ body: r }).then(function (e) { return parseFloat(e) }) }, t.prototype.finishUpload = function (e, n, r) { return new t(this, "finishUpload(uploadId=guid'" + e + "',fileOffset=" + n + ")").postAs({ body: r }).then(function (e) { return { data: e, file: new t(e.ServerRelativeUrl) } }) }, t }(o.QueryableInstance); t.File = l; var p = function (e) { function t(t, n) { return void 0 === n && (n = "versions"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new f(this); return t.concat("(" + e + ")"), t }, t.prototype.deleteAll = function () { return new t(this, "deleteAll").post() }, t.prototype.deleteById = function (e) { return new t(this, "deleteById(vid=" + e + ")").post() }, t.prototype.deleteByLabel = function (e) { return new t(this, "deleteByLabel(versionlabel='" + e + "')").post() }, t.prototype.restoreByLabel = function (e) { return new t(this, "restoreByLabel(versionlabel='" + e + "')").post() }, t }(o.QueryableCollection); t.Versions = p; var f = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.delete = function (e) { return void 0 === e && (e = "*"), this.post({ headers: { "IF-Match": e, "X-HTTP-Method": "DELETE" } }) }, t }(o.QueryableInstance); t.Version = f; var d; !function (e) { e[e.Minor = 0] = "Minor", e[e.Major = 1] = "Major", e[e.Overwrite = 2] = "Overwrite" }(d = t.CheckinType || (t.CheckinType = {})); var h; !function (e) { e[e.User = 0] = "User", e[e.Shared = 1] = "Shared" }(h = t.WebPartsPersonalizationScope || (t.WebPartsPersonalizationScope = {})); var y; !function (e) { e[e.Overwrite = 1] = "Overwrite", e[e.AllowBrokenThickets = 8] = "AllowBrokenThickets" }(y = t.MoveOperations || (t.MoveOperations = {})); !function (e) { e[e.StandardPage = 0] = "StandardPage", e[e.WikiPage = 1] = "WikiPage", e[e.FormPage = 2] = "FormPage" }(t.TemplateFileType || (t.TemplateFileType = {})) }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(23), i = n(45), a = n(11), u = n(21), s = n(40), c = n(43), l = n(1), p = n(12), f = n(0), d = n(15), h = n(3), y = n(2), g = function (e) { function t(t, n) { return void 0 === n && (n = "lists"), e.call(this, t, n) || this } return r(t, e), t.prototype.getByTitle = function (e) { return new v(this, "getByTitle('" + e + "')") }, t.prototype.getById = function (e) { var t = new v(this); return t.concat("('" + e + "')"), t }, t.prototype.add = function (e, t, n, r, o) { var i = this; void 0 === t && (t = ""), void 0 === n && (n = 100), void 0 === r && (r = !1), void 0 === o && (o = {}); var a = f.Util.extend({ AllowContentTypes: r, BaseTemplate: n, ContentTypesEnabled: r, Description: t, Title: e, __metadata: { type: "SP.List" } }, o); return this.post({ body: JSON.stringify(a) }).then(function (e) { return { data: e, list: i.getByTitle(a.Title) } }) }, t.prototype.ensure = function (e, t, n, r, o) { var i = this; if (void 0 === t && (t = ""), void 0 === n && (n = 100), void 0 === r && (r = !1), void 0 === o && (o = {}), this.hasBatch) throw new y.NotSupportedInBatchException("The ensure list method"); return new Promise(function (a, u) { var s = f.Util.extend(o, { Title: e, Description: t, ContentTypesEnabled: r }, !0), c = i.getByTitle(s.Title); c.get().then(function (e) { c.update(s).then(function (e) { a({ created: !1, data: e, list: i.getByTitle(s.Title) }) }).catch(function (e) { return u(e) }) }).catch(function (o) { i.add(e, t, n, r, s).then(function (e) { a({ created: !0, data: e.data, list: i.getByTitle(s.Title) }) }).catch(function (e) { return u(e) }) }) }) }, t.prototype.ensureSiteAssetsLibrary = function () { return new t(this, "ensuresiteassetslibrary").post().then(function (e) { return new v(h.extractOdataId(e)) }) }, t.prototype.ensureSitePagesLibrary = function () { return new t(this, "ensuresitepageslibrary").post().then(function (e) { return new v(h.extractOdataId(e)) }) }, t }(l.QueryableCollection); t.Lists = g; var v = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "contentTypes", { get: function () { return new a.ContentTypes(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "items", { get: function () { return new o.Items(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "views", { get: function () { return new i.Views(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "fields", { get: function () { return new u.Fields(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "forms", { get: function () { return new s.Forms(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "defaultView", { get: function () { return new l.QueryableInstance(this, "DefaultView") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "userCustomActions", { get: function () { return new d.UserCustomActions(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "effectiveBasePermissions", { get: function () { return new l.Queryable(this, "EffectiveBasePermissions") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "eventReceivers", { get: function () { return new l.QueryableCollection(this, "EventReceivers") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "relatedFields", { get: function () { return new l.Queryable(this, "getRelatedFields") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "informationRightsManagementSettings", { get: function () { return new l.Queryable(this, "InformationRightsManagementSettings") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "subscriptions", { get: function () { return new c.Subscriptions(this) }, enumerable: !0, configurable: !0 }), t.prototype.getView = function (e) { return new i.View(this, "getView('" + e + "')") }, t.prototype.update = function (e, n) { var r = this; void 0 === n && (n = "*"); var o = JSON.stringify(f.Util.extend({ __metadata: { type: "SP.List" } }, e)); return this.post({ body: o, headers: { "IF-Match": n, "X-HTTP-Method": "MERGE" } }).then(function (n) { var o = r; return e.hasOwnProperty("Title") && (o = r.getParent(t, r.parentUrl, "getByTitle('" + e.Title + "')")), { data: n, list: o } }) }, t.prototype.delete = function (e) { return void 0 === e && (e = "*"), this.post({ headers: { "IF-Match": e, "X-HTTP-Method": "DELETE" } }) }, t.prototype.getChanges = function (e) { var n = JSON.stringify({ query: f.Util.extend({ __metadata: { type: "SP.ChangeQuery" } }, e) }); return new t(this, "getchanges").post({ body: n }) }, t.prototype.getItemsByCAMLQuery = function (e) { for (var n = [], r = 1; r < arguments.length; r++) n[r - 1] = arguments[r]; var o = JSON.stringify({ query: f.Util.extend({ __metadata: { type: "SP.CamlQuery" } }, e) }), i = new t(this, "getitems"); return i.expand.apply(i, n).post({ body: o }) }, t.prototype.getListItemChangesSinceToken = function (e) { var n = JSON.stringify({ query: f.Util.extend({ __metadata: { type: "SP.ChangeLogItemQuery" } }, e) }); return new t(this, "getlistitemchangessincetoken").post({ body: n }, { parse: function (e) { return e.text() } }) }, t.prototype.recycle = function () { return this.append("recycle"), this.post().then(function (e) { return e.hasOwnProperty("Recycle") ? e.Recycle : e }) }, t.prototype.renderListData = function (e) { var n = new t(this, "renderlistdata(@viewXml)"); return n.query.add("@viewXml", "'" + e + "'"), n.post().then(function (e) { return e = JSON.parse(e), e.hasOwnProperty("RenderListData") ? e.RenderListData : e }) }, t.prototype.renderListFormData = function (e, n, r) { return new t(this, "renderlistformdata(itemid=" + e + ", formid='" + n + "', mode=" + r + ")").post().then(function (e) { return e = JSON.parse(e), e.hasOwnProperty("ListData") ? e.ListData : e }) }, t.prototype.reserveListItemId = function () { return new t(this, "reservelistitemid").post().then(function (e) { return e.hasOwnProperty("ReserveListItemId") ? e.ReserveListItemId : e }) }, t.prototype.getListItemEntityTypeFullName = function () { return new l.QueryableInstance(this).select("ListItemEntityTypeFullName").getAs().then(function (e) { return e.ListItemEntityTypeFullName }) }, t }(p.QueryableSecurable); t.List = v }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), o = function () { function e(e, t) { this.store = e, this.defaultTimeoutMinutes = t, this.defaultTimeoutMinutes = void 0 === t ? 5 : t, this.enabled = this.test() } return e.prototype.get = function (e) { if (!this.enabled) return null; var t = this.store.getItem(e); if (null == t) return null; var n = JSON.parse(t); return new Date(n.expiration) <= new Date ? (this.delete(e), null) : n.value }, e.prototype.put = function (e, t, n) { this.enabled && this.store.setItem(e, this.createPersistable(t, n)) }, e.prototype.delete = function (e) { this.enabled && this.store.removeItem(e) }, e.prototype.getOrPut = function (e, t, n) { var r = this; return this.enabled ? new Promise(function (o) { var i = r.get(e); null == i ? t().then(function (t) { r.put(e, t, n), o(t) }) : o(i) }) : t() }, e.prototype.test = function () { var e = "test"; try { return this.store.setItem(e, e), this.store.removeItem(e), !0 } catch (e) { return !1 } }, e.prototype.createPersistable = function (e, t) { return void 0 === t && (t = r.Util.dateAdd(new Date, "minute", this.defaultTimeoutMinutes)), JSON.stringify({ expiration: t, value: e }) }, e }(); t.PnPClientStorageWrapper = o; var i = function () { function e() { this.local = "undefined" != typeof localStorage ? new o(localStorage) : null, this.session = "undefined" != typeof sessionStorage ? new o(sessionStorage) : null } return e }(); t.PnPClientStorage = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(36), o = n(0), i = n(4), a = n(2), u = function () { function e() { this._impl = i.RuntimeConfig.fetchClientFactory(), this._digestCache = new r.DigestCache(this) } return e.prototype.fetch = function (e, t) { var n = this; void 0 === t && (t = {}); var r = o.Util.extend(t, { cache: "no-cache", credentials: "same-origin" }, !0), u = new Headers; if (this.mergeHeaders(u, i.RuntimeConfig.headers), this.mergeHeaders(u, t.headers), u.has("Accept") || u.append("Accept", "application/json"), u.has("Content-Type") || u.append("Content-Type", "application/json;odata=verbose;charset=utf-8"), u.has("X-ClientService-ClientTag") || u.append("X-ClientService-ClientTag", "PnPCoreJS:2.0.2"), r = o.Util.extend(r, { headers: u }), r.method && "GET" !== r.method.toUpperCase() && !u.has("X-RequestDigest")) { var s = e.indexOf("_api/"); if (s < 0) throw new a.APIUrlException; var c = e.substr(0, s); return this._digestCache.getDigest(c).then(function (t) { return u.append("X-RequestDigest", t), n.fetchRaw(e, r) }) } return this.fetchRaw(e, r) }, e.prototype.fetchRaw = function (e, t) { var n = this; void 0 === t && (t = {}); var r = new Headers; this.mergeHeaders(r, t.headers), t = o.Util.extend(t, { headers: r }); var i = function (r) { n._impl.fetch(e, t).then(function (e) { return r.resolve(e) }).catch(function (e) { var t = r.delay; 429 !== e.status && 503 !== e.status && r.reject(e), r.delay *= 2, r.attempts++, r.retryCount <= r.attempts && r.reject(e), setTimeout(o.Util.getCtxCallback(n, i, r), t) }) }; return new Promise(function (e, t) { var r = { attempts: 0, delay: 100, reject: t, resolve: e, retryCount: 7 }; i.call(n, r) }) }, e.prototype.get = function (e, t) { void 0 === t && (t = {}); var n = o.Util.extend(t, { method: "GET" }); return this.fetch(e, n) }, e.prototype.post = function (e, t) { void 0 === t && (t = {}); var n = o.Util.extend(t, { method: "POST" }); return this.fetch(e, n) }, e.prototype.patch = function (e, t) { void 0 === t && (t = {}); var n = o.Util.extend(t, { method: "PATCH" }); return this.fetch(e, n) }, e.prototype.delete = function (e, t) { void 0 === t && (t = {}); var n = o.Util.extend(t, { method: "DELETE" }); return this.fetch(e, n) }, e.prototype.mergeHeaders = function (e, t) { if (void 0 !== t && null !== t) { new Request("", { headers: t }).headers.forEach(function (t, n) { e.append(n, t) }) } }, e }(); t.HttpClient = u }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(0), i = n(1), a = function (e) { function t(t, n) { return void 0 === n && (n = "contenttypes"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new u(this); return t.concat("('" + e + "')"), t }, t.prototype.addAvailableContentType = function (e) { var n = this, r = JSON.stringify({ contentTypeId: e }); return new t(this, "addAvailableContentType").postAs({ body: r }).then(function (e) { return { contentType: n.getById(e.id), data: e } }) }, t.prototype.add = function (e, t, n, r, i) { var a = this; void 0 === n && (n = ""), void 0 === r && (r = "Custom Content Types"), void 0 === i && (i = {}); var u = JSON.stringify(o.Util.extend({ Description: n, Group: r, Id: { StringValue: e }, Name: t, __metadata: { type: "SP.ContentType" } }, i)); return this.post({ body: u }).then(function (e) { return { contentType: a.getById(e.id), data: e } }) }, t }(i.QueryableCollection); t.ContentTypes = a; var u = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "fieldLinks", { get: function () { return new s(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "fields", { get: function () { return new i.QueryableCollection(this, "fields") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "parent", { get: function () { return new t(this, "parent") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "workflowAssociations", { get: function () { return new i.QueryableCollection(this, "workflowAssociations") }, enumerable: !0, configurable: !0 }), t }(i.QueryableInstance); t.ContentType = u; var s = function (e) { function t(t, n) { return void 0 === n && (n = "fieldlinks"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new c(this); return t.concat("(guid'" + e + "')"), t }, t }(i.QueryableCollection); t.FieldLinks = s; var c = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t }(i.QueryableInstance); t.FieldLink = c }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(13), i = n(1), a = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r(t, e), Object.defineProperty(t.prototype, "roleAssignments", { get: function () { return new o.RoleAssignments(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "firstUniqueAncestorSecurableObject", { get: function () { return new i.QueryableInstance(this, "FirstUniqueAncestorSecurableObject") }, enumerable: !0, configurable: !0 }), t.prototype.getUserEffectivePermissions = function (e) { var t = new i.Queryable(this, "getUserEffectivePermissions(@user)"); return t.query.add("@user", "'" + encodeURIComponent(e) + "'"), t }, t.prototype.breakRoleInheritance = function (e, t) { return void 0 === e && (e = !1), void 0 === t && (t = !1), new (function (e) { function t(t, n, r) { return e.call(this, t, "breakroleinheritance(copyroleassignments=" + n + ", clearsubscopes=" + r + ")") || this } return r(t, e), t.prototype.break = function () { return this.post() }, t }(i.Queryable))(this, e, t).break() }, t.prototype.resetRoleInheritance = function () { return new (function (e) { function t(t) { return e.call(this, t, "resetroleinheritance") || this } return r(t, e), t.prototype.reset = function () { return this.post() }, t }(i.Queryable))(this).reset() }, t }(i.QueryableInstance); t.QueryableSecurable = a }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(14), a = n(0), u = function (e) { function t(t, n) { return void 0 === n && (n = "roleassignments"), e.call(this, t, n) || this } return r(t, e), t.prototype.add = function (e, n) { return new t(this, "addroleassignment(principalid=" + e + ", roledefid=" + n + ")").post() }, t.prototype.remove = function (e, n) { return new t(this, "removeroleassignment(principalid=" + e + ", roledefid=" + n + ")").post() }, t.prototype.getById = function (e) { var t = new s(this); return t.concat("(" + e + ")"), t }, t }(o.QueryableCollection); t.RoleAssignments = u; var s = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "groups", { get: function () { return new i.SiteGroups(this, "groups") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "bindings", { get: function () { return new p(this) }, enumerable: !0, configurable: !0 }), t.prototype.delete = function () { return this.post({ headers: { "X-HTTP-Method": "DELETE" } }) }, t }(o.QueryableInstance); t.RoleAssignment = s; var c = function (e) { function t(t, n) { return void 0 === n && (n = "roledefinitions"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { return new l(this, "getById(" + e + ")") }, t.prototype.getByName = function (e) { return new l(this, "getbyname('" + e + "')") }, t.prototype.getByType = function (e) { return new l(this, "getbytype(" + e + ")") }, t.prototype.add = function (e, t, n, r) { var o = this, i = JSON.stringify({ BasePermissions: a.Util.extend({ __metadata: { type: "SP.BasePermissions" } }, r), Description: t, Name: e, Order: n, __metadata: { type: "SP.RoleDefinition" } }); return this.post({ body: i }).then(function (e) { return { data: e, definition: o.getById(e.Id) } }) }, t }(o.QueryableCollection); t.RoleDefinitions = c; var l = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.update = function (e) { var t = this; void 0 !== e.hasOwnProperty("BasePermissions") && (e.BasePermissions = a.Util.extend({ __metadata: { type: "SP.BasePermissions" } }, e.BasePermissions)); var n = JSON.stringify(a.Util.extend({ __metadata: { type: "SP.RoleDefinition" } }, e)); return this.post({ body: n, headers: { "X-HTTP-Method": "MERGE" } }).then(function (n) { var r = t; if (e.hasOwnProperty("Name")) { r = t.getParent(c, t.parentUrl, "").getByName(e.Name) } return { data: n, definition: r } }) }, t.prototype.delete = function () { return this.post({ headers: { "X-HTTP-Method": "DELETE" } }) }, t }(o.QueryableInstance); t.RoleDefinition = l; var p = function (e) { function t(t, n) { return void 0 === n && (n = "roledefinitionbindings"), e.call(this, t, n) || this } return r(t, e), t }(o.QueryableCollection); t.RoleDefinitionBindings = p }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(28), a = n(0); !function (e) { e[e.None = 0] = "None", e[e.User = 1] = "User", e[e.DistributionList = 2] = "DistributionList", e[e.SecurityGroup = 4] = "SecurityGroup", e[e.SharePointGroup = 8] = "SharePointGroup", e[e.All = 15] = "All" }(t.PrincipalType || (t.PrincipalType = {})); var u = function (e) { function t(t, n) { return void 0 === n && (n = "sitegroups"), e.call(this, t, n) || this } return r(t, e), t.prototype.add = function (e) { var t = this, n = JSON.stringify(a.Util.extend({ __metadata: { type: "SP.Group" } }, e)); return this.post({ body: n }).then(function (e) { return { data: e, group: t.getById(e.Id) } }) }, t.prototype.getByName = function (e) { return new s(this, "getByName('" + e + "')") }, t.prototype.getById = function (e) { var t = new s(this); return t.concat("(" + e + ")"), t }, t.prototype.removeById = function (e) { return new t(this, "removeById('" + e + "')").post() }, t.prototype.removeByLoginName = function (e) { return new t(this, "removeByLoginName('" + e + "')").post() }, t }(o.QueryableCollection); t.SiteGroups = u; var s = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "users", { get: function () { return new i.SiteUsers(this, "users") }, enumerable: !0, configurable: !0 }), t.prototype.update = function (e) { var n = this, r = a.Util.extend({ __metadata: { type: "SP.Group" } }, e); return this.post({ body: JSON.stringify(r), headers: { "X-HTTP-Method": "MERGE" } }).then(function (r) { var o = n; return e.hasOwnProperty("Title") && (o = n.getParent(t, n.parentUrl, "getByName('" + e.Title + "')")), { data: r, group: o } }) }, t }(o.QueryableInstance); t.SiteGroup = s }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(0), a = function (e) { function t(t, n) { return void 0 === n && (n = "usercustomactions"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new u(this); return t.concat("('" + e + "')"), t }, t.prototype.add = function (e) { var t = this, n = JSON.stringify(i.Util.extend({ __metadata: { type: "SP.UserCustomAction" } }, e)); return this.post({ body: n }).then(function (e) { return { action: t.getById(e.Id), data: e } }) }, t.prototype.clear = function () { return new t(this, "clear").post() }, t }(o.QueryableCollection); t.UserCustomActions = a; var u = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.update = function (e) { var t = this, n = JSON.stringify(i.Util.extend({ __metadata: { type: "SP.UserCustomAction" } }, e)); return this.post({ body: n, headers: { "X-HTTP-Method": "MERGE" } }).then(function (e) { return { action: t, data: e } }) }, t.prototype.delete = function () { return e.prototype.delete.call(this) }, t }(o.QueryableInstance); t.UserCustomAction = u }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(12), a = n(8), u = n(21), s = n(24), c = n(14), l = n(11), p = n(22), f = n(13), d = n(7), h = n(0), y = n(8), g = n(28), v = n(15), b = n(3), m = n(20), w = function (e) { function t(t, n) { return void 0 === n && (n = "webs"), e.call(this, t, n) || this } return r(t, e), t.prototype.add = function (e, n, r, o, i, a, u) { void 0 === r && (r = ""), void 0 === o && (o = "STS"), void 0 === i && (i = 1033), void 0 === a && (a = !0), void 0 === u && (u = {}); var s = h.Util.extend({ Description: r, Language: i, Title: e, Url: n, UseSamePermissionsAsParentSite: a, WebTemplate: o }, u), c = JSON.stringify({ parameters: h.Util.extend({ __metadata: { type: "SP.WebCreationInformation" } }, s) }); return new t(this, "add").post({ body: c }).then(function (e) { return { data: e, web: new P(b.extractOdataId(e).replace(/_api\/web\/?/i, "")) } }) }, t }(o.QueryableCollection); t.Webs = w; var P = function (e) { function t(t, n) { return void 0 === n && (n = "_api/web"), e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "webs", { get: function () { return new w(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "contentTypes", { get: function () { return new l.ContentTypes(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "lists", { get: function () { return new a.Lists(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "fields", { get: function () { return new u.Fields(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "features", { get: function () { return new m.Features(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "availablefields", { get: function () { return new u.Fields(this, "availablefields") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "navigation", { get: function () { return new s.Navigation(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "siteUsers", { get: function () { return new g.SiteUsers(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "siteGroups", { get: function () { return new c.SiteGroups(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "currentUser", { get: function () { return new g.CurrentUser(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "folders", { get: function () { return new p.Folders(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "userCustomActions", { get: function () { return new v.UserCustomActions(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "roleDefinitions", { get: function () { return new f.RoleDefinitions(this) }, enumerable: !0, configurable: !0 }), t.prototype.createBatch = function () { return new b.ODataBatch(this.parentUrl) }, t.prototype.getFolderByServerRelativeUrl = function (e) { return new p.Folder(this, "getFolderByServerRelativeUrl('" + e + "')") }, t.prototype.getFileByServerRelativeUrl = function (e) { return new d.File(this, "getFileByServerRelativeUrl('" + e + "')") }, t.prototype.getList = function (e) { return new y.List(this, "getList('" + e + "')") }, t.prototype.update = function (e) { var t = this, n = JSON.stringify(h.Util.extend({ __metadata: { type: "SP.Web" } }, e)); return this.post({ body: n, headers: { "X-HTTP-Method": "MERGE" } }).then(function (e) { return { data: e, web: t } }) }, t.prototype.delete = function () { return e.prototype.delete.call(this) }, t.prototype.applyTheme = function (e, n, r, o) { var i = JSON.stringify({ backgroundImageUrl: r, colorPaletteUrl: e, fontSchemeUrl: n, shareGenerated: o }); return new t(this, "applytheme").post({ body: i }) }, t.prototype.applyWebTemplate = function (e) { var n = new t(this, "applywebtemplate"); return n.concat("(@t)"), n.query.add("@t", e), n.post() }, t.prototype.doesUserHavePermissions = function (e) { var n = new t(this, "doesuserhavepermissions"); return n.concat("(@p)"), n.query.add("@p", JSON.stringify(e)), n.get() }, t.prototype.ensureUser = function (e) { var n = JSON.stringify({ logonName: e }); return new t(this, "ensureuser").post({ body: n }) }, t.prototype.availableWebTemplates = function (e, t) { return void 0 === e && (e = 1033), void 0 === t && (t = !0), new o.QueryableCollection(this, "getavailablewebtemplates(lcid=" + e + ", doincludecrosslanguage=" + t + ")") }, t.prototype.getCatalog = function (e) { var n = new t(this, "getcatalog(" + e + ")"); return n.select("Id"), n.get().then(function (e) { return new y.List(b.extractOdataId(e)) }) }, t.prototype.getChanges = function (e) { var n = JSON.stringify({ query: h.Util.extend({ __metadata: { type: "SP.ChangeQuery" } }, e) }); return new t(this, "getchanges").post({ body: n }) }, Object.defineProperty(t.prototype, "customListTemplate", { get: function () { return new o.QueryableCollection(this, "getcustomlisttemplates") }, enumerable: !0, configurable: !0 }), t.prototype.getUserById = function (e) { return new g.SiteUser(this, "getUserById(" + e + ")") }, t.prototype.mapToIcon = function (e, n, r) { return void 0 === n && (n = 0), void 0 === r && (r = ""), new t(this, "maptoicon(filename='" + e + "', progid='" + r + "', size=" + n + ")").get() }, t }(i.QueryableSecurable); t.Web = P }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(9), o = n(2), i = function () { function e(e, t, n) { this.wrappedProvider = e, this.store = n ? n : this.selectPnPCache(), this.cacheKey = "_configcache_" + t } return e.prototype.getWrappedProvider = function () { return this.wrappedProvider }, e.prototype.getConfiguration = function () { var e = this; if (!this.store || !this.store.enabled) return this.wrappedProvider.getConfiguration(); var t = this.store.get(this.cacheKey); if (t) return new Promise(function (e) { e(t) }); var n = this.wrappedProvider.getConfiguration(); return n.then(function (t) { e.store.put(e.cacheKey, t) }), n }, e.prototype.selectPnPCache = function () { var e = new r.PnPClientStorage; if (e.local && e.local.enabled) return e.local; if (e.session && e.session.enabled) return e.session; throw new o.NoCacheAvailableException }, e }(); t.default = i }, function (e, t, n) { "use strict"; (function (e) { Object.defineProperty(t, "__esModule", { value: !0 }); var n = function () { function t() { } return t.prototype.fetch = function (t, n) { return e.fetch(t, n) }, t }(); t.FetchClient = n }).call(t, n(30)) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(9), o = n(0), i = n(4), a = function () { function e(e) { this.key = e, this.expiration = o.Util.dateAdd(new Date, "second", i.RuntimeConfig.defaultCachingTimeoutSeconds), this.storeName = i.RuntimeConfig.defaultCachingStore } return Object.defineProperty(e.prototype, "store", { get: function () { return "local" === this.storeName ? e.storage.local : e.storage.session }, enumerable: !0, configurable: !0 }), e }(); a.storage = new r.PnPClientStorage, t.CachingOptions = a; var u = function () { function e(e, t) { this._parser = e, this._cacheOptions = t } return e.prototype.parse = function (e) { var t = this; return this._parser.parse(e).then(function (e) { return null !== t._cacheOptions.store && t._cacheOptions.store.put(t._cacheOptions.key, e, t._cacheOptions.expiration), e }) }, e }(); t.CachingParserWrapper = u }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = function (e) { function t(t, n) { return void 0 === n && (n = "features"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new a(this); return t.concat("('" + e + "')"), t }, t.prototype.add = function (e, n) { var r = this; return void 0 === n && (n = !1), new t(this, "add").post({ body: JSON.stringify({ featdefScope: 0, featureId: e, force: n }) }).then(function (t) { return { data: t, feature: r.getById(e) } }) }, t.prototype.remove = function (e, n) { return void 0 === n && (n = !1), new t(this, "remove").post({ body: JSON.stringify({ featureId: e, force: n }) }) }, t }(o.QueryableCollection); t.Features = i; var a = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.deactivate = function (e) { var n = this; void 0 === e && (e = !1); var r = this.addBatchDependency(); return new t(this).select("DefinitionId").getAs().then(function (t) { var o = n.getParent(i, n.parentUrl, "").remove(t.DefinitionId, e); return r(), o }) }, t }(o.QueryableInstance); t.Feature = a }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(0), a = n(29), u = function (e) { function t(t, n) { return void 0 === n && (n = "fields"), e.call(this, t, n) || this } return r(t, e), t.prototype.getByTitle = function (e) { return new s(this, "getByTitle('" + e + "')") }, t.prototype.getByInternalNameOrTitle = function (e) { return new s(this, "getByInternalNameOrTitle('" + e + "')") }, t.prototype.getById = function (e) { var t = new s(this); return t.concat("('" + e + "')"), t }, t.prototype.createFieldAsXml = function (e) { var n, r = this; n = "string" == typeof e ? { SchemaXml: e } : e; var o = JSON.stringify({ parameters: i.Util.extend({ __metadata: { type: "SP.XmlSchemaFieldCreationInformation" } }, n) }); return new t(this, "createfieldasxml").postAs({ body: o }).then(function (e) { return { data: e, field: r.getById(e.Id) } }) }, t.prototype.add = function (e, t, n) { var r = this; void 0 === n && (n = {}); var o = JSON.stringify(i.Util.extend({ Title: e, __metadata: { type: t } }, n)); return this.postAs({ body: o }).then(function (e) { return { data: e, field: r.getById(e.Id) } }) }, t.prototype.addText = function (e, t, n) { void 0 === t && (t = 255); var r = { FieldTypeKind: 2, MaxLength: t }; return this.add(e, "SP.FieldText", i.Util.extend(r, n)) }, t.prototype.addCalculated = function (e, t, n, r, o) { void 0 === r && (r = a.FieldTypes.Text); var u = { DateFormat: n, FieldTypeKind: 17, Formula: t, OutputType: r }; return this.add(e, "SP.FieldCalculated", i.Util.extend(u, o)) }, t.prototype.addDateTime = function (e, t, n, r, o) { void 0 === t && (t = a.DateTimeFieldFormatType.DateOnly), void 0 === n && (n = a.CalendarType.Gregorian), void 0 === r && (r = 0); var u = { DateTimeCalendarType: n, DisplayFormat: t, FieldTypeKind: 4, FriendlyDisplayFormat: r }; return this.add(e, "SP.FieldDateTime", i.Util.extend(u, o)) }, t.prototype.addNumber = function (e, t, n, r) { var o = { FieldTypeKind: 9 }; return void 0 !== t && (o = i.Util.extend({ MinimumValue: t }, o)), void 0 !== n && (o = i.Util.extend({ MaximumValue: n }, o)), this.add(e, "SP.FieldNumber", i.Util.extend(o, r)) }, t.prototype.addCurrency = function (e, t, n, r, o) { void 0 === r && (r = 1033); var a = { CurrencyLocaleId: r, FieldTypeKind: 10 }; return void 0 !== t && (a = i.Util.extend({ MinimumValue: t }, a)), void 0 !== n && (a = i.Util.extend({ MaximumValue: n }, a)), this.add(e, "SP.FieldCurrency", i.Util.extend(a, o)) }, t.prototype.addMultilineText = function (e, t, n, r, o, a, u) { void 0 === t && (t = 6), void 0 === n && (n = !0), void 0 === r && (r = !1), void 0 === o && (o = !1), void 0 === a && (a = !0); var s = { AllowHyperlink: a, AppendOnly: o, FieldTypeKind: 3, NumberOfLines: t, RestrictedMode: r, RichText: n }; return this.add(e, "SP.FieldMultiLineText", i.Util.extend(s, u)) }, t.prototype.addUrl = function (e, t, n) { void 0 === t && (t = a.UrlFieldFormatType.Hyperlink); var r = { DisplayFormat: t, FieldTypeKind: 11 }; return this.add(e, "SP.FieldUrl", i.Util.extend(r, n)) }, t }(o.QueryableCollection); t.Fields = u; var s = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.update = function (e, t) { var n = this; void 0 === t && (t = "SP.Field"); var r = JSON.stringify(i.Util.extend({ __metadata: { type: t } }, e)); return this.post({ body: r, headers: { "X-HTTP-Method": "MERGE" } }).then(function (e) { return { data: e, field: n } }) }, t.prototype.delete = function () { return this.post({ headers: { "X-HTTP-Method": "DELETE" } }) }, t.prototype.setShowInDisplayForm = function (e) { return new t(this, "setshowindisplayform(" + e + ")").post() }, t.prototype.setShowInEditForm = function (e) { return new t(this, "setshowineditform(" + e + ")").post() }, t.prototype.setShowInNewForm = function (e) { return new t(this, "setshowinnewform(" + e + ")").post() }, t }(o.QueryableInstance); t.Field = s }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(7), a = function (e) { function t(t, n) { return void 0 === n && (n = "folders"), e.call(this, t, n) || this } return r(t, e), t.prototype.getByName = function (e) { var t = new u(this); return t.concat("('" + e + "')"), t }, t.prototype.add = function (e) { var n = this; return new t(this, "add('" + e + "')").post().then(function (t) { return { data: t, folder: n.getByName(e) } }) }, t }(o.QueryableCollection); t.Folders = a; var u = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "contentTypeOrder", { get: function () { return new o.QueryableCollection(this, "contentTypeOrder") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "files", { get: function () { return new i.Files(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "folders", { get: function () { return new a(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "listItemAllFields", { get: function () { return new o.QueryableCollection(this, "listItemAllFields") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "parentFolder", { get: function () { return new t(this, "parentFolder") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "properties", { get: function () { return new o.QueryableInstance(this, "properties") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "serverRelativeUrl", { get: function () { return new o.Queryable(this, "serverRelativeUrl") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "uniqueContentTypeOrder", { get: function () { return new o.QueryableCollection(this, "uniqueContentTypeOrder") }, enumerable: !0, configurable: !0 }), t.prototype.delete = function (e) { return void 0 === e && (e = "*"), new t(this).post({ headers: { "IF-Match": e, "X-HTTP-Method": "DELETE" } }) }, t.prototype.recycle = function () { return new t(this, "recycle").post() }, t }(o.QueryableInstance); t.Folder = u }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(12), a = n(22), u = n(7), s = n(11), c = n(0), l = n(3), p = n(39), f = n(8), d = function (e) { function t(t, n) { return void 0 === n && (n = "items"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new h(this); return t.concat("(" + e + ")"), t }, t.prototype.skip = function (e) { return this._query.add("$skiptoken", encodeURIComponent("Paged=TRUE&p_ID=" + e)), this }, t.prototype.getPaged = function () { return this.getAs(new g) }, t.prototype.add = function (e, t) { var n = this; void 0 === e && (e = {}), void 0 === t && (t = null); var r = this.addBatchDependency(); return this.ensureListItemEntityTypeName(t).then(function (t) { var o = JSON.stringify(c.Util.extend({ __metadata: { type: t } }, e)), i = n.postAs({ body: o }).then(function (e) { return { data: e, item: n.getById(e.Id) } }); return r(), i }) }, t.prototype.ensureListItemEntityTypeName = function (e) { return e ? Promise.resolve(e) : this.getParent(f.List).getListItemEntityTypeFullName() }, t }(o.QueryableCollection); t.Items = d; var h = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "attachmentFiles", { get: function () { return new p.AttachmentFiles(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "contentType", { get: function () { return new s.ContentType(this, "ContentType") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "effectiveBasePermissions", { get: function () { return new o.Queryable(this, "EffectiveBasePermissions") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "effectiveBasePermissionsForUI", { get: function () { return new o.Queryable(this, "EffectiveBasePermissionsForUI") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "fieldValuesAsHTML", { get: function () { return new o.QueryableInstance(this, "FieldValuesAsHTML") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "fieldValuesAsText", { get: function () { return new o.QueryableInstance(this, "FieldValuesAsText") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "fieldValuesForEdit", { get: function () { return new o.QueryableInstance(this, "FieldValuesForEdit") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "folder", { get: function () { return new a.Folder(this, "folder") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "file", { get: function () { return new u.File(this, "file") }, enumerable: !0, configurable: !0 }), t.prototype.update = function (e, t) { var n = this; return void 0 === t && (t = "*"), new Promise(function (r, i) { var a = n.addBatchDependency(); n.getParent(o.QueryableInstance, n.parentUrl.substr(0, n.parentUrl.lastIndexOf("/"))).select("ListItemEntityTypeFullName").getAs().then(function (o) { var i = JSON.stringify(c.Util.extend({ __metadata: { type: o.ListItemEntityTypeFullName } }, e)); return a(), n.post({ body: i, headers: { "IF-Match": t, "X-HTTP-Method": "MERGE" } }, new v).then(function (e) { r({ data: e, item: n }) }) }).catch(function (e) { return i(e) }) }) }, t.prototype.delete = function (e) { return void 0 === e && (e = "*"), this.post({ headers: { "IF-Match": e, "X-HTTP-Method": "DELETE" } }) }, t.prototype.recycle = function () { return new t(this, "recycle").post() }, t.prototype.getWopiFrameUrl = function (e) { void 0 === e && (e = 0); var n = new t(this, "getWOPIFrameUrl(@action)"); return n._query.add("@action", e), n.post().then(function (e) { return e.GetWOPIFrameUrl }) }, t.prototype.validateUpdateListItem = function (e, n) { void 0 === n && (n = !1); var r = JSON.stringify({ formValues: e, bNewDocumentUpdate: n }); return new t(this, "validateupdatelistitem").post({ body: r }) }, t }(i.QueryableSecurable); t.Item = h; var y = function () { function e(e, t) { this.nextUrl = e, this.results = t } return Object.defineProperty(e.prototype, "hasNext", { get: function () { return "string" == typeof this.nextUrl && this.nextUrl.length > 0 }, enumerable: !0, configurable: !0 }), e.prototype.getNext = function () { if (this.hasNext) { return new d(this.nextUrl, null).getPaged() } return new Promise(function (e) { return e(null) }) }, e }(); t.PagedItemCollection = y; var g = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r(t, e), t.prototype.parse = function (e) { var t = this; return new Promise(function (n, r) { t.handleError(e, r) && e.json().then(function (e) { n(new y(e.hasOwnProperty("d") && e.d.hasOwnProperty("__next") ? e.d.__next : e["odata.nextLink"], t.parseODataJSON(e))) }) }) }, t }(l.ODataParserBase), v = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return r(t, e), t.prototype.parse = function (e) { var t = this; return new Promise(function (n, r) { t.handleError(e, r) && n({ "odata.etag": e.headers.get("etag") }) }) }, t }(l.ODataParserBase) }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(0), i = n(1), a = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new u(this); return t.concat("(" + e + ")"), t }, t.prototype.add = function (e, n, r) { var o = this; void 0 === r && (r = !0); var i = JSON.stringify({ IsVisible: r, Title: e, Url: n, __metadata: { type: "SP.NavigationNode" } }); return new t(this).post({ body: i }).then(function (e) { return { data: e, node: o.getById(e.Id) } }) }, t.prototype.moveAfter = function (e, n) { var r = JSON.stringify({ nodeId: e, previousNodeId: n }); return new t(this, "MoveAfter").post({ body: r }) }, t }(i.QueryableCollection); t.NavigationNodes = a; var u = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "children", { get: function () { return new a(this, "Children") }, enumerable: !0, configurable: !0 }), t.prototype.update = function (e) { var t = this, n = JSON.stringify(o.Util.extend({ __metadata: { type: "SP.NavigationNode" } }, e)); return this.post({ body: n, headers: { "X-HTTP-Method": "MERGE" } }).then(function (e) { return { data: e, node: t } }) }, t.prototype.delete = function () { return e.prototype.delete.call(this) }, t }(i.QueryableInstance); t.NavigationNode = u; var s = function (e) { function t(t, n) { return void 0 === n && (n = "navigation"), e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "quicklaunch", { get: function () { return new a(this, "quicklaunch") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "topNavigationBar", { get: function () { return new a(this, "topnavigationbar") }, enumerable: !0, configurable: !0 }), t }(i.Queryable); t.Navigation = s }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(0), a = function (e) { function t(t, n) { return void 0 === n && (n = "_api/search/postquery"), e.call(this, t, n) || this } return r(t, e), t.prototype.execute = function (e) { var t; t = e, t.SelectProperties && (t.SelectProperties = { results: e.SelectProperties }), t.RefinementFilters && (t.RefinementFilters = { results: e.RefinementFilters }), t.SortList && (t.SortList = { results: e.SortList }), t.HithighlightedProperties && (t.HithighlightedProperties = { results: e.HithighlightedProperties }), t.ReorderingRules && (t.ReorderingRules = { results: e.ReorderingRules }), t.Properties && (t.Properties = { results: e.Properties }); var n = JSON.stringify({ request: i.Util.extend({ __metadata: { type: "Microsoft.Office.Server.Search.REST.SearchRequest" } }, t) }); return this.post({ body: n }).then(function (e) { return new u(e) }) }, t }(o.QueryableInstance); t.Search = a; var u = function () { function e(e) { var t = e.postquery ? e.postquery : e; this.PrimarySearchResults = this.formatSearchResults(t.PrimaryQueryResult.RelevantResults.Table.Rows), this.RawSearchResults = t, this.ElapsedTime = t.ElapsedTime, this.RowCount = t.PrimaryQueryResult.RelevantResults.RowCount, this.TotalRows = t.PrimaryQueryResult.RelevantResults.TotalRows, this.TotalRowsIncludingDuplicates = t.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates } return e.prototype.formatSearchResults = function (e) { for (var t = new Array, n = e.results ? e.results : e, r = 0, o = n; r < o.length; r++) { var i = o[r]; t.push(new s(i.Cells)) } return t }, e }(); t.SearchResults = u; var s = function () { function e(e) { for (var t = e.results ? e.results : e, n = 0, r = t; n < r.length; n++) { var o = r[n]; Object.defineProperty(this, o.Key, { configurable: !1, enumerable: !1, value: o.Value, writable: !1 }) } } return e }(); t.SearchResult = s; !function (e) { e[e.Ascending = 0] = "Ascending", e[e.Descending = 1] = "Descending", e[e.FQLFormula = 2] = "FQLFormula" }(t.SortDirection || (t.SortDirection = {})); !function (e) { e[e.ResultContainsKeyword = 0] = "ResultContainsKeyword", e[e.TitleContainsKeyword = 1] = "TitleContainsKeyword", e[e.TitleMatchesKeyword = 2] = "TitleMatchesKeyword", e[e.UrlStartsWith = 3] = "UrlStartsWith", e[e.UrlExactlyMatches = 4] = "UrlExactlyMatches", e[e.ContentTypeIs = 5] = "ContentTypeIs", e[e.FileExtensionMatches = 6] = "FileExtensionMatches", e[e.ResultHasTag = 7] = "ResultHasTag", e[e.ManualCondition = 8] = "ManualCondition" }(t.ReorderingRuleMatchType || (t.ReorderingRuleMatchType = {})); !function (e) { e[e.None = 0] = "None", e[e.StringType = 1] = "StringType", e[e.Int32TYpe = 2] = "Int32TYpe", e[e.BooleanType = 3] = "BooleanType", e[e.StringArrayType = 4] = "StringArrayType", e[e.UnSupportedType = 5] = "UnSupportedType" }(t.QueryPropertyValueType || (t.QueryPropertyValueType = {})) }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = function (e) { function t(t, n) { return void 0 === n && (n = "_api/search/suggest"), e.call(this, t, n) || this } return r(t, e), t.prototype.execute = function (e) { return this.mapQueryToQueryString(e), this.get().then(function (e) { return new a(e) }) }, t.prototype.mapQueryToQueryString = function (e) { this.query.add("querytext", "'" + e.querytext + "'"), e.hasOwnProperty("count") && this.query.add("inumberofquerysuggestions", e.count.toString()), e.hasOwnProperty("personalCount") && this.query.add("inumberofresultsuggestions", e.personalCount.toString()), e.hasOwnProperty("preQuery") && this.query.add("fprequerysuggestions", e.preQuery.toString()), e.hasOwnProperty("hitHighlighting") && this.query.add("fhithighlighting", e.hitHighlighting.toString()), e.hasOwnProperty("capitalize") && this.query.add("fcapitalizefirstletters", e.capitalize.toString()), e.hasOwnProperty("culture") && this.query.add("culture", e.culture.toString()), e.hasOwnProperty("stemming") && this.query.add("enablestemming", e.stemming.toString()), e.hasOwnProperty("includePeople") && this.query.add("showpeoplenamesuggestions", e.includePeople.toString()), e.hasOwnProperty("queryRules") && this.query.add("enablequeryrules", e.queryRules.toString()), e.hasOwnProperty("prefixMatch") && this.query.add("fprefixmatchallterms", e.prefixMatch.toString()) }, t }(o.QueryableInstance); t.SearchSuggest = i; var a = function () { function e(e) { e.hasOwnProperty("suggest") ? (this.PeopleNames = e.suggest.PeopleNames.results, this.PersonalResults = e.suggest.PersonalResults.results, this.Queries = e.suggest.Queries.results) : (this.PeopleNames = e.PeopleNames, this.PersonalResults = e.PersonalResults, this.Queries = e.Queries) } return e }(); t.SearchSuggestResult = a }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(16), a = n(15), u = n(3), s = n(20), c = function (e) { function t(t, n) { return void 0 === n && (n = "_api/site"), e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "rootWeb", { get: function () { return new i.Web(this, "rootweb") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "features", { get: function () { return new s.Features(this) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "userCustomActions", { get: function () { return new a.UserCustomActions(this) }, enumerable: !0, configurable: !0 }), t.prototype.getContextInfo = function () { return new t(this.parentUrl, "_api/contextinfo").post().then(function (e) { if (e.hasOwnProperty("GetContextWebInformation")) { var t = e.GetContextWebInformation; return t.SupportedSchemaVersions = t.SupportedSchemaVersions.results, t } return e }) }, t.prototype.getDocumentLibraries = function (e) { var t = new o.Queryable("", "_api/sp.web.getdocumentlibraries(@v)"); return t.query.add("@v", "'" + e + "'"), t.get().then(function (e) { return e.hasOwnProperty("GetDocumentLibraries") ? e.GetDocumentLibraries : e }) }, t.prototype.getWebUrlFromPageUrl = function (e) { var t = new o.Queryable("", "_api/sp.web.getweburlfrompageurl(@v)"); return t.query.add("@v", "'" + e + "'"), t.get().then(function (e) { return e.hasOwnProperty("GetWebUrlFromPageUrl") ? e.GetWebUrlFromPageUrl : e }) }, t.prototype.createBatch = function () { return new u.ODataBatch(this.parentUrl) }, t }(o.QueryableInstance); t.Site = c }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(14), a = n(0), u = function (e) { function t(t, n) { return void 0 === n && (n = "siteusers"), e.call(this, t, n) || this } return r(t, e), t.prototype.getByEmail = function (e) { return new s(this, "getByEmail('" + e + "')") }, t.prototype.getById = function (e) { return new s(this, "getById(" + e + ")") }, t.prototype.getByLoginName = function (e) { var t = new s(this); return t.concat("(@v)"), t.query.add("@v", encodeURIComponent(e)), t }, t.prototype.removeById = function (e) { return new t(this, "removeById(" + e + ")").post() }, t.prototype.removeByLoginName = function (e) { var n = new t(this, "removeByLoginName(@v)"); return n.query.add("@v", encodeURIComponent(e)), n.post() }, t.prototype.add = function (e) { var t = this, n = JSON.stringify({ __metadata: { type: "SP.User" }, LoginName: e }); return this.post({ body: n }).then(function () { return t.getByLoginName(e) }) }, t }(o.QueryableCollection); t.SiteUsers = u; var s = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "groups", { get: function () { return new i.SiteGroups(this, "groups") }, enumerable: !0, configurable: !0 }), t.prototype.update = function (e) { var t = this, n = a.Util.extend({ __metadata: { type: "SP.User" } }, e); return this.post({ body: JSON.stringify(n), headers: { "X-HTTP-Method": "MERGE" } }).then(function (e) { return { data: e, user: t } }) }, t.prototype.delete = function () { return this.post({ headers: { "X-HTTP-Method": "DELETE" } }) }, t }(o.QueryableInstance); t.SiteUser = s; var c = function (e) { function t(t, n) { return void 0 === n && (n = "currentuser"), e.call(this, t, n) || this } return r(t, e), t }(o.QueryableInstance); t.CurrentUser = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); !function (e) { e[e.Display = 1] = "Display", e[e.Edit = 2] = "Edit", e[e.New = 3] = "New" }(t.ControlMode || (t.ControlMode = {})); !function (e) { e[e.Invalid = 0] = "Invalid", e[e.Integer = 1] = "Integer", e[e.Text = 2] = "Text", e[e.Note = 3] = "Note", e[e.DateTime = 4] = "DateTime", e[e.Counter = 5] = "Counter", e[e.Choice = 6] = "Choice", e[e.Lookup = 7] = "Lookup", e[e.Boolean = 8] = "Boolean", e[e.Number = 9] = "Number", e[e.Currency = 10] = "Currency", e[e.URL = 11] = "URL", e[e.Computed = 12] = "Computed", e[e.Threading = 13] = "Threading", e[e.Guid = 14] = "Guid", e[e.MultiChoice = 15] = "MultiChoice", e[e.GridChoice = 16] = "GridChoice", e[e.Calculated = 17] = "Calculated", e[e.File = 18] = "File", e[e.Attachments = 19] = "Attachments", e[e.User = 20] = "User", e[e.Recurrence = 21] = "Recurrence", e[e.CrossProjectLink = 22] = "CrossProjectLink", e[e.ModStat = 23] = "ModStat", e[e.Error = 24] = "Error", e[e.ContentTypeId = 25] = "ContentTypeId", e[e.PageSeparator = 26] = "PageSeparator", e[e.ThreadIndex = 27] = "ThreadIndex", e[e.WorkflowStatus = 28] = "WorkflowStatus", e[e.AllDayEvent = 29] = "AllDayEvent", e[e.WorkflowEventType = 30] = "WorkflowEventType" }(t.FieldTypes || (t.FieldTypes = {})); !function (e) { e[e.DateOnly = 0] = "DateOnly", e[e.DateTime = 1] = "DateTime" }(t.DateTimeFieldFormatType || (t.DateTimeFieldFormatType = {})); !function (e) { e[e.DefaultValue = 0] = "DefaultValue", e[e.AddToDefaultContentType = 1] = "AddToDefaultContentType", e[e.AddToNoContentType = 2] = "AddToNoContentType", e[e.AddToAllContentTypes = 4] = "AddToAllContentTypes", e[e.AddFieldInternalNameHint = 8] = "AddFieldInternalNameHint", e[e.AddFieldToDefaultView = 16] = "AddFieldToDefaultView", e[e.AddFieldCheckDisplayName = 32] = "AddFieldCheckDisplayName" }(t.AddFieldOptions || (t.AddFieldOptions = {})); !function (e) { e[e.Gregorian = 1] = "Gregorian", e[e.Japan = 3] = "Japan", e[e.Taiwan = 4] = "Taiwan", e[e.Korea = 5] = "Korea", e[e.Hijri = 6] = "Hijri", e[e.Thai = 7] = "Thai", e[e.Hebrew = 8] = "Hebrew", e[e.GregorianMEFrench = 9] = "GregorianMEFrench", e[e.GregorianArabic = 10] = "GregorianArabic", e[e.GregorianXLITEnglish = 11] = "GregorianXLITEnglish", e[e.GregorianXLITFrench = 12] = "GregorianXLITFrench", e[e.KoreaJapanLunar = 14] = "KoreaJapanLunar", e[e.ChineseLunar = 15] = "ChineseLunar", e[e.SakaEra = 16] = "SakaEra", e[e.UmAlQura = 23] = "UmAlQura" }(t.CalendarType || (t.CalendarType = {})); !function (e) { e[e.Hyperlink = 0] = "Hyperlink", e[e.Image = 1] = "Image" }(t.UrlFieldFormatType || (t.UrlFieldFormatType = {})); !function (e) { e[e.None = 0] = "None", e[e.User = 1] = "User", e[e.DistributionList = 2] = "DistributionList", e[e.SecurityGroup = 4] = "SecurityGroup", e[e.SharePointGroup = 8] = "SharePointGroup", e[e.All = 15] = "All" }(t.PrincipalType || (t.PrincipalType = {})); !function (e) { e[e.Invalid = -1] = "Invalid", e[e.DefaultView = 0] = "DefaultView", e[e.NormalView = 1] = "NormalView", e[e.DialogView = 2] = "DialogView", e[e.View = 3] = "View", e[e.DisplayForm = 4] = "DisplayForm", e[e.DisplayFormDialog = 5] = "DisplayFormDialog", e[e.EditForm = 6] = "EditForm", e[e.EditFormDialog = 7] = "EditFormDialog", e[e.NewForm = 8] = "NewForm", e[e.NewFormDialog = 9] = "NewFormDialog", e[e.SolutionForm = 10] = "SolutionForm", e[e.PAGE_MAXITEMS = 11] = "PAGE_MAXITEMS" }(t.PageType || (t.PageType = {})) }, function (e, t) { var n; n = function () { return this }(); try { n = n || Function("return this")() || (0, eval)("this") } catch (e) { "object" == typeof window && (n = window) } e.exports = n }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(6), o = function () { function e() { this._settings = new r.Dictionary } return e.prototype.add = function (e, t) { this._settings.add(e, t) }, e.prototype.addJSON = function (e, t) { this._settings.add(e, JSON.stringify(t)) }, e.prototype.apply = function (e) { var t = this; return new Promise(function (n, r) { try { t._settings.merge(e), n() } catch (e) { r(e) } }) }, e.prototype.load = function (e) { var t = this; return new Promise(function (n, r) { e.getConfiguration().then(function (e) { t._settings.merge(e), n() }).catch(function (e) { r(e) }) }) }, e.prototype.get = function (e) { return this._settings.get(e) }, e.prototype.getJSON = function (e) { var t = this.get(e); return void 0 === t || null === t ? t : JSON.parse(t) }, e }(); t.Settings = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(25), o = n(26), i = n(27), a = n(16), u = n(0), s = n(44), c = n(2), l = function () { function e() { } return e.prototype.searchSuggest = function (e) { var t; return t = "string" == typeof e ? { querytext: e } : e, new o.SearchSuggest("").execute(t) }, e.prototype.search = function (e) { var t; return t = "string" == typeof e ? { Querytext: e } : e, new r.Search("").execute(t) }, Object.defineProperty(e.prototype, "site", { get: function () { return new i.Site("") }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "web", { get: function () { return new a.Web("") }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "profiles", { get: function () { return new s.UserProfileQuery("") }, enumerable: !0, configurable: !0 }), e.prototype.createBatch = function () { return this.web.createBatch() }, e.prototype.crossDomainSite = function (e, t) { return this._cdImpl(i.Site, e, t, "site") }, e.prototype.crossDomainWeb = function (e, t) { return this._cdImpl(a.Web, e, t, "web") }, e.prototype._cdImpl = function (e, t, n, r) { if (!u.Util.isUrlAbsolute(t)) throw new c.UrlException("The addInWebUrl parameter must be an absolute url."); if (!u.Util.isUrlAbsolute(n)) throw new c.UrlException("The hostWebUrl parameter must be an absolute url."); var o = u.Util.combinePaths(t, "_api/SP.AppContextSite(@target)"), i = new e(o, r); return i.query.add("@target", "'" + encodeURIComponent(n) + "'"), i }, e }(); t.Rest = l }, function (e, t, n) { "use strict"; function r(e) { for (var n in e) t.hasOwnProperty(n) || (t[n] = e[n]) } Object.defineProperty(t, "__esModule", { value: !0 }), r(n(41)); var o = n(10); t.HttpClient = o.HttpClient; var i = n(38); t.SPRequestExecutorClient = i.SPRequestExecutorClient; var a = n(37); t.NodeFetchClient = a.NodeFetchClient; var u = n(18); t.FetchClient = u.FetchClient, r(n(34)); var s = n(6); t.Dictionary = s.Dictionary; var c = n(0); t.Util = c.Util, r(n(5)), r(n(2)) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(17); t.CachingConfigurationProvider = r.default; var o = n(35); t.SPListConfigurationProvider = o.default }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(17), o = function () { function e(e, t) { void 0 === t && (t = "config"), this.sourceWeb = e, this.sourceListTitle = t } return Object.defineProperty(e.prototype, "web", { get: function () { return this.sourceWeb }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "listTitle", { get: function () { return this.sourceListTitle }, enumerable: !0, configurable: !0 }), e.prototype.getConfiguration = function () { return this.web.lists.getByTitle(this.listTitle).items.select("Title", "Value").getAs().then(function (e) { return e.reduce(function (e, t) { return Object.defineProperty(e, t.Title, { configurable: !1, enumerable: !1, value: t.Value, writable: !1 }) }, {}) }) }, e.prototype.asCaching = function () { var e = "splist_" + this.web.toUrl() + "+" + this.listTitle; return new r.default(this, e) }, e }(); t.default = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(6), o = n(0), i = n(3), a = function () { function e() { } return e }(); t.CachedDigest = a; var u = new r.Dictionary, s = function () { function e(e, t) { void 0 === t && (t = u), this._httpClient = e, this._digests = t } return e.prototype.getDigest = function (e) { var t = this, n = this._digests.get(e); if (null !== n) { if (new Date < n.expiration) return Promise.resolve(n.value) } var r = o.Util.combinePaths(e, "/_api/contextinfo"); return this._httpClient.fetchRaw(r, { cache: "no-cache", credentials: "same-origin", headers: { Accept: "application/json;odata=verbose", "Content-type": "application/json;odata=verbose;charset=utf-8" }, method: "POST" }).then(function (e) { return (new i.ODataDefaultParser).parse(e).then(function (e) { return e.GetContextWebInformation }) }).then(function (n) { var r = new a; r.value = n.FormDigestValue; var o = n.FormDigestTimeoutSeconds, i = new Date; return i.setTime(i.getTime() + 1e3 * o), r.expiration = i, t._digests.add(e, r), r.value }) }, e.prototype.clear = function () { this._digests.clear() }, e }(); t.DigestCache = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(2), o = function () { function e() { } return e.prototype.fetch = function () { throw new r.NodeFetchClientUnsupportedException }, e }(); t.NodeFetchClient = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), o = n(2), i = function () { function e() { this.convertToResponse = function (e) { var t = new Headers; for (var n in e.headers) e.headers[n] && t.append(n, e.headers[n]); var r = 204 === e.statusCode ? null : e.body; return new Response(r, { headers: t, status: e.statusCode, statusText: e.statusText }) } } return e.prototype.fetch = function (e, t) { var n = this; if ("undefined" == typeof SP || void 0 === SP.RequestExecutor) throw new o.SPRequestExecutorUndefinedException; var i, a, u = e.substring(0, e.indexOf("/_api")), s = new SP.RequestExecutor(u), c = {}; if (t.headers && t.headers instanceof Headers) for (i = t.headers.entries(), a = i.next() ; !a.done;) c[a.value[0]] = a.value[1], a = i.next(); else c = t.headers; return new Promise(function (o, i) { var a = { error: function (e) { i(n.convertToResponse(e)) }, headers: c, method: t.method, success: function (e) { o(n.convertToResponse(e)) }, url: e }; a = t.body ? r.Util.extend(a, { body: t.body }) : r.Util.extend(a, { binaryStringRequestBody: !0 }), s.executeAsync(a) }) }, e }(); t.SPRequestExecutorClient = i }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(3), a = function (e) { function t(t, n) { return void 0 === n && (n = "AttachmentFiles"), e.call(this, t, n) || this } return r(t, e), t.prototype.getByName = function (e) { var t = new u(this); return t.concat("('" + e + "')"), t }, t.prototype.add = function (e, n) { var r = this; return new t(this, "add(FileName='" + e + "')").post({ body: n }).then(function (t) { return { data: t, file: r.getByName(e) } }) }, t }(o.QueryableCollection); t.AttachmentFiles = a; var u = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.getText = function () { return new t(this, "$value").get(new i.TextFileParser) }, t.prototype.getBlob = function () { return new t(this, "$value").get(new i.BlobFileParser) }, t.prototype.getBuffer = function () { return new t(this, "$value").get(new i.BufferFileParser) }, t.prototype.getJSON = function () { return new t(this, "$value").get(new i.JSONFileParser) }, t.prototype.setContent = function (e) { var n = this; return new t(this, "$value").post({ body: e, headers: { "X-HTTP-Method": "PUT" } }).then(function (e) { return new t(n) }) }, t.prototype.delete = function (e) { return void 0 === e && (e = "*"), this.post({ headers: { "IF-Match": e, "X-HTTP-Method": "DELETE" } }) }, t }(o.QueryableInstance); t.AttachmentFile = u }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = function (e) { function t(t, n) { return void 0 === n && (n = "forms"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new a(this); return t.concat("('" + e + "')"), t }, t }(o.QueryableCollection); t.Forms = i; var a = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t }(o.QueryableInstance); t.Form = a }, function (e, t, n) { "use strict"; function r(e) { for (var n in e) t.hasOwnProperty(n) || (t[n] = e[n]) } Object.defineProperty(t, "__esModule", { value: !0 }), r(n(19)); var o = n(7); t.CheckinType = o.CheckinType, t.WebPartsPersonalizationScope = o.WebPartsPersonalizationScope, t.MoveOperations = o.MoveOperations, t.TemplateFileType = o.TemplateFileType; var i = n(23); t.Item = i.Item, t.PagedItemCollection = i.PagedItemCollection; var a = n(24); t.NavigationNodes = a.NavigationNodes, t.NavigationNode = a.NavigationNode; var u = n(8); t.List = u.List; var s = n(3); t.extractOdataId = s.extractOdataId, t.ODataParserBase = s.ODataParserBase, t.ODataDefaultParser = s.ODataDefaultParser, t.ODataRaw = s.ODataRaw, t.ODataValue = s.ODataValue, t.ODataEntity = s.ODataEntity, t.ODataEntityArray = s.ODataEntityArray, t.TextFileParser = s.TextFileParser, t.BlobFileParser = s.BlobFileParser, t.BufferFileParser = s.BufferFileParser, t.JSONFileParser = s.JSONFileParser; var c = n(1); t.Queryable = c.Queryable, t.QueryableInstance = c.QueryableInstance, t.QueryableCollection = c.QueryableCollection; var l = n(13); t.RoleDefinitionBindings = l.RoleDefinitionBindings; var p = n(25); t.Search = p.Search, t.SearchResult = p.SearchResult, t.SearchResults = p.SearchResults, t.SortDirection = p.SortDirection, t.ReorderingRuleMatchType = p.ReorderingRuleMatchType, t.QueryPropertyValueType = p.QueryPropertyValueType; var f = n(26); t.SearchSuggest = f.SearchSuggest, t.SearchSuggestResult = f.SearchSuggestResult; var d = n(27); t.Site = d.Site, r(n(29)); var h = n(16); t.Web = h.Web }, function (e, t, n) { "use strict"; function r(e) { return [l.logStart, l.caching, l.send, l.logEnd].reduce(function (e, t) { return e.then(function (e) { return t(e) }) }, Promise.resolve(e)).then(function (e) { return l.returnResult(e) }).catch(function (e) { throw s.Logger.log({ data: e, level: s.LogLevel.Error, message: "Error in request pipeline: " + e.message }), e }) } function o(e) { return void 0 === e && (e = !1), function (t, n, r) { var o = r.value; r.value = function () { for (var r = [], i = 0; i < arguments.length; i++) r[i] = arguments[i]; return !e && r.length > 0 && r[0].hasOwnProperty("hasResult") && r[0].hasResult ? (s.Logger.write("[" + r[0].requestId + "] (" + (new Date).getTime() + ") Skipping request pipeline method " + n + ", existing result in pipeline.", s.LogLevel.Verbose), Promise.resolve(r[0])) : (s.Logger.write("[" + r[0].requestId + "] (" + (new Date).getTime() + ") Calling request pipeline method " + n + ".", s.LogLevel.Verbose), o.apply(t, r)) } } } var i = this && this.__decorate || function (e, t, n, r) { var o, i = arguments.length, a = i < 3 ? t : null === r ? r = Object.getOwnPropertyDescriptor(t, n) : r; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) a = Reflect.decorate(e, t, n, r); else for (var u = e.length - 1; u >= 0; u--) (o = e[u]) && (a = (i < 3 ? o(a) : i > 3 ? o(t, n, a) : o(t, n)) || a); return i > 3 && a && Object.defineProperty(t, n, a), a }; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(19), u = n(10), s = n(5), c = n(0); t.pipe = r; var l = function () { function e() { } return e.logStart = function (e) { return new Promise(function (t) { s.Logger.log({ data: s.Logger.activeLogLevel === s.LogLevel.Info ? {} : e, level: s.LogLevel.Info, message: "[" + e.requestId + "] (" + (new Date).getTime() + ") Beginning " + e.verb + " request to " + e.requestAbsoluteUrl }), t(e) }) }, e.caching = function (t) { return new Promise(function (n) { if ("GET" === t.verb && t.isCached) { s.Logger.write("[" + t.requestId + "] (" + (new Date).getTime() + ") Caching is enabled for request, checking cache...", s.LogLevel.Info); var r = new a.CachingOptions(t.requestAbsoluteUrl.toLowerCase()); if (void 0 !== t.cachingOptions && (r = c.Util.extend(r, t.cachingOptions)), null !== r.store) { var o = r.store.get(r.key); if (null !== o) return s.Logger.log({ data: s.Logger.activeLogLevel === s.LogLevel.Info ? {} : o, level: s.LogLevel.Info, message: "[" + t.requestId + "] (" + (new Date).getTime() + ") Value returned from cache." }), t.batchDependency(), e.setResult(t, o).then(function (e) { return n(e) }) } s.Logger.write("[" + t.requestId + "] (" + (new Date).getTime() + ") Value not found in cache.", s.LogLevel.Info), t.parser = new a.CachingParserWrapper(t.parser, r) } return n(t) }) }, e.send = function (t) { return new Promise(function (n, r) { if (t.isBatched) { var o = t.batch.add(t.requestAbsoluteUrl, t.verb, t.options, t.parser); t.batchDependency(), s.Logger.write("[" + t.requestId + "] (" + (new Date).getTime() + ") Batching request.", s.LogLevel.Info), n(o.then(function (n) { return e.setResult(t, n) })) } else { s.Logger.write("[" + t.requestId + "] (" + (new Date).getTime() + ") Sending request.", s.LogLevel.Info); var i = new u.HttpClient, a = c.Util.extend(t.options || {}, { method: t.verb }); i.fetch(t.requestAbsoluteUrl, a).then(function (e) { return t.parser.parse(e) }).then(function (n) { return e.setResult(t, n) }).then(function (e) { return n(e) }).catch(function (e) { return r(e) }) } }) }, e.logEnd = function (e) { return new Promise(function (t) { s.Logger.log({ data: s.Logger.activeLogLevel === s.LogLevel.Info ? {} : e, level: s.LogLevel.Info, message: "[" + e.requestId + "] (" + (new Date).getTime() + ") Completing " + e.verb + " request to " + e.requestAbsoluteUrl }), t(e) }) }, e.returnResult = function (e) { return s.Logger.log({ data: e.result, level: s.LogLevel.Verbose, message: "[" + e.requestId + "] (" + (new Date).getTime() + ") Returning, see data property for value." }), Promise.resolve(e.result) }, e.setResult = function (e, t) { return new Promise(function (n) { e.result = t, e.hasResult = !0, n(e) }) }, e }(); i([o(!0)], l, "logStart", null), i([o()], l, "caching", null), i([o()], l, "send", null), i([o(!0)], l, "logEnd", null), i([o(!0)], l, "returnResult", null) }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = function (e) { function t(t, n) { return void 0 === n && (n = "subscriptions"), e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { var t = new a(this); return t.concat("('" + e + "')"), t }, t.prototype.add = function (e, t, n) { var r = this, o = JSON.stringify({ clientState: n || "pnp-js-core-subscription", expirationDateTime: t, notificationUrl: e, resource: this.toUrl() }); return this.post({ body: o, headers: { "Content-Type": "application/json" } }).then(function (e) { return { data: e, subscription: r.getById(e.id) } }) }, t }(o.QueryableCollection); t.Subscriptions = i; var a = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.update = function (e) { var t = this, n = JSON.stringify({ expirationDateTime: e }); return this.patch({ body: n, headers: { "Content-Type": "application/json" } }).then(function (e) { return { data: e, subscription: t } }) }, t.prototype.delete = function () { return e.prototype.delete.call(this) }, t }(o.QueryableInstance); t.Subscription = a }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(48), a = n(3), u = function (e) { function t(t, n) { void 0 === n && (n = "_api/sp.userprofiles.peoplemanager"); var r = e.call(this, t, n) || this; return r.profileLoader = new s(t), r } return r(t, e), Object.defineProperty(t.prototype, "editProfileLink", { get: function () { return new t(this, "EditProfileLink").getAs(a.ODataValue()) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "isMyPeopleListPublic", { get: function () { return new t(this, "IsMyPeopleListPublic").getAs(a.ODataValue()) }, enumerable: !0, configurable: !0 }), t.prototype.amIFollowedBy = function (e) { var n = new t(this, "amifollowedby(@v)"); return n.query.add("@v", "'" + encodeURIComponent(e) + "'"), n.get() }, t.prototype.amIFollowing = function (e) { var n = new t(this, "amifollowing(@v)"); return n.query.add("@v", "'" + encodeURIComponent(e) + "'"), n.get() }, t.prototype.getFollowedTags = function (e) { return void 0 === e && (e = 20), new t(this, "getfollowedtags(" + e + ")").get() }, t.prototype.getFollowersFor = function (e) { var n = new t(this, "getfollowersfor(@v)"); return n.query.add("@v", "'" + encodeURIComponent(e) + "'"), n.get() }, Object.defineProperty(t.prototype, "myFollowers", { get: function () { return new o.QueryableCollection(this, "getmyfollowers") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "myProperties", { get: function () { return new t(this, "getmyproperties") }, enumerable: !0, configurable: !0 }), t.prototype.getPeopleFollowedBy = function (e) { var n = new t(this, "getpeoplefollowedby(@v)"); return n.query.add("@v", "'" + encodeURIComponent(e) + "'"), n.get() }, t.prototype.getPropertiesFor = function (e) { var n = new t(this, "getpropertiesfor(@v)"); return n.query.add("@v", "'" + encodeURIComponent(e) + "'"), n.get() }, Object.defineProperty(t.prototype, "trendingTags", { get: function () { var e = new t(this, null); return e.concat(".gettrendingtags"), e.get() }, enumerable: !0, configurable: !0 }), t.prototype.getUserProfilePropertyFor = function (e, n) { var r = new t(this, "getuserprofilepropertyfor(accountname=@v, propertyname='" + n + "')"); return r.query.add("@v", "'" + encodeURIComponent(e) + "'"), r.get() }, t.prototype.hideSuggestion = function (e) { var n = new t(this, "hidesuggestion(@v)"); return n.query.add("@v", "'" + encodeURIComponent(e) + "'"), n.post() }, t.prototype.isFollowing = function (e, n) { var r = new t(this, null); return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"), r.query.add("@v", "'" + encodeURIComponent(e) + "'"), r.query.add("@y", "'" + encodeURIComponent(n) + "'"), r.get() }, t.prototype.setMyProfilePic = function (e) { var n = this; return new Promise(function (r, o) { i.readBlobAsArrayBuffer(e).then(function (e) { new t(n, "setmyprofilepicture").post({ body: String.fromCharCode.apply(null, new Uint16Array(e)) }).then(function (e) { return r() }) }).catch(function (e) { return o(e) }) }) }, t.prototype.createPersonalSiteEnqueueBulk = function () { for (var e = [], t = 0; t < arguments.length; t++) e[t] = arguments[t]; return this.profileLoader.createPersonalSiteEnqueueBulk(e) }, Object.defineProperty(t.prototype, "ownerUserProfile", { get: function () { return this.profileLoader.ownerUserProfile }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "userProfile", { get: function () { return this.profileLoader.userProfile }, enumerable: !0, configurable: !0 }), t.prototype.createPersonalSite = function (e) { return void 0 === e && (e = !1), this.profileLoader.createPersonalSite(e) }, t.prototype.shareAllSocialData = function (e) { return this.profileLoader.shareAllSocialData(e) }, t }(o.QueryableInstance); t.UserProfileQuery = u; var s = function (e) { function t(t, n) { return void 0 === n && (n = "_api/sp.userprofiles.profileloader.getprofileloader"), e.call(this, t, n) || this } return r(t, e), t.prototype.createPersonalSiteEnqueueBulk = function (e) { var n = new t(this, "createpersonalsiteenqueuebulk"), r = JSON.stringify({ emailIDs: e }); return n.post({ body: r }) }, Object.defineProperty(t.prototype, "ownerUserProfile", { get: function () { return this.getParent(t, this.parentUrl, "_api/sp.userprofiles.profileloader.getowneruserprofile").postAs() }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "userProfile", { get: function () { return new t(this, "getuserprofile").postAs() }, enumerable: !0, configurable: !0 }), t.prototype.createPersonalSite = function (e) { return void 0 === e && (e = !1), new t(this, "getuserprofile/createpersonalsiteenque(" + e + ')",').post() }, t.prototype.shareAllSocialData = function (e) { return new t(this, "getuserprofile/shareallsocialdata(" + e + ')",').post() }, t }(o.Queryable) }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = n(0), a = function (e) { function t(t) { return e.call(this, t, "views") || this } return r(t, e), t.prototype.getById = function (e) { var t = new u(this); return t.concat("('" + e + "')"), t }, t.prototype.getByTitle = function (e) { return new u(this, "getByTitle('" + e + "')") }, t.prototype.add = function (e, t, n) { var r = this; void 0 === t && (t = !1), void 0 === n && (n = {}); var o = JSON.stringify(i.Util.extend({ PersonalView: t, Title: e, __metadata: { type: "SP.View" } }, n)); return this.postAs({ body: o }).then(function (e) { return { data: e, view: r.getById(e.Id) } }) }, t }(o.QueryableCollection); t.Views = a; var u = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "fields", { get: function () { return new s(this) }, enumerable: !0, configurable: !0 }), t.prototype.update = function (e) { var t = this, n = JSON.stringify(i.Util.extend({ __metadata: { type: "SP.View" } }, e)); return this.post({ body: n, headers: { "X-HTTP-Method": "MERGE" } }).then(function (e) { return { data: e, view: t } }) }, t.prototype.delete = function () { return this.post({ headers: { "X-HTTP-Method": "DELETE" } }) }, t.prototype.renderAsHtml = function () { return new o.Queryable(this, "renderashtml").get() }, t }(o.QueryableInstance); t.View = u; var s = function (e) { function t(t, n) { return void 0 === n && (n = "viewfields"), e.call(this, t, n) || this } return r(t, e), t.prototype.getSchemaXml = function () { return new o.Queryable(this, "schemaxml").get() }, t.prototype.add = function (e) { return new t(this, "addviewfield('" + e + "')").post() }, t.prototype.move = function (e, n) { var r = new t(this, "moveviewfieldto"), o = JSON.stringify({ field: e, index: n }); return r.post({ body: o }) }, t.prototype.removeAll = function () { return new t(this, "removeallviewfields").post() }, t.prototype.remove = function (e) { return new t(this, "removeviewfield('" + e + "')").post() }, t }(o.QueryableCollection); t.ViewFields = s }, function (e, t, n) { "use strict"; var r = this && this.__extends || function () { var e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }; return function (t, n) { function r() { this.constructor = t } e(t, n), t.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(); Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(1), i = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "webparts", { get: function () { return new a(this, "webparts") }, enumerable: !0, configurable: !0 }), t.prototype.export = function (e) { return new t(this, "ExportWebPart").post({ body: JSON.stringify({ webPartId: e }) }) }, t.prototype.import = function (e) { return new t(this, "ImportWebPart").post({ body: JSON.stringify({ webPartXml: e }) }) }, t }(o.Queryable); t.LimitedWebPartManager = i; var a = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), t.prototype.getById = function (e) { return new u(this, "getbyid('" + e + "')") }, t }(o.QueryableCollection); t.WebPartDefinitions = a; var u = function (e) { function t(t, n) { return e.call(this, t, n) || this } return r(t, e), Object.defineProperty(t.prototype, "webpart", { get: function () { return new s(this) }, enumerable: !0, configurable: !0 }), t.prototype.delete = function () { return new t(this, "DeleteWebPart").post() }, t }(o.QueryableInstance); t.WebPartDefinition = u; var s = function (e) { function t(t, n) { return void 0 === n && (n = "webpart"), e.call(this, t, n) || this } return r(t, e), t }(o.QueryableInstance); t.WebPart = s }, function (e, t, n) { "use strict"; function r(e) { return function (t, n, r) { var i = r.value; r.value = function () { for (var a = [], u = 0; u < arguments.length; u++) a[u] = arguments[u]; return o.Logger.log({ data: { descriptor: r, propertyKey: n, target: t }, level: o.LogLevel.Warning, message: e }), i.apply(this, a) } } } Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(5); t.deprecated = r }, function (e, t, n) { "use strict"; function r(e) { return i(e, "string") } function o(e) { return i(e, "buffer") } function i(e, t) { return new Promise(function (n, r) { try { var o = new FileReader; switch (o.onload = function (e) { n(e.target.result) }, t) { case "string": o.readAsText(e); break; case "buffer": o.readAsArrayBuffer(e) } } catch (e) { r(e) } }) } Object.defineProperty(t, "__esModule", { value: !0 }), t.readBlobAsText = r, t.readBlobAsArrayBuffer = o }, function (e, t, n) { "use strict"; function r(e) { for (var n in e) t.hasOwnProperty(n) || (t[n] = e[n]) } Object.defineProperty(t, "__esModule", { value: !0 }); var o = n(0), i = n(9), a = n(31), u = n(5), s = n(32), c = n(4); t.util = o.Util, t.sp = new s.Rest, t.storage = new i.PnPClientStorage, t.config = new a.Settings, t.log = u.Logger, t.setup = c.setRuntimeConfig, r(n(33)); var l = { config: t.config, log: t.log, setup: t.setup, sp: t.sp, storage: t.storage, util: t.util }; t.default = l }]) });